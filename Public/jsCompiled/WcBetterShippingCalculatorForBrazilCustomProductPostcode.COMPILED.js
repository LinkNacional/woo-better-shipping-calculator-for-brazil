/*! For license information please see WcBetterShippingCalculatorForBrazilCustomProductPostcode.COMPILED.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,o,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",c=r.toStringTag||"@@toStringTag";function i(t,r,a,c){var i=r&&r.prototype instanceof d?r:d,l=Object.create(i.prototype);return n(l,"_invoke",function(t,n,r){var a,c,i,d=0,l=r||[],u=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,c=0,i=e,p.n=n,s}};function m(t,n){for(c=t,i=n,o=0;!u&&d&&!r&&o<l.length;o++){var r,a=l[o],m=p.p,b=a[2];t>3?(r=b===n)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=m&&((r=t<2&&m<a[1])?(c=0,p.v=n,p.n=a[1]):m<b&&(r=t<3||a[0]>n||n>b)&&(a[4]=t,a[5]=n,p.n=b,c=0))}if(r||t>1)return s;throw u=!0,n}return function(r,l,b){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&m(l,b),c=l,i=b;(o=c<2?e:i)||!u;){a||(c?c<3?(c>1&&(p.n=-1),m(c,i)):p.n=i:p.v=i);try{if(d=2,a){if(c||(r="next"),o=a[r]){if(!(o=o.call(a,i)))throw TypeError("iterator result is not an object");if(!o.done)return o;i=o.value,c<2&&(c=0)}else 1===c&&(o=a.return)&&o.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),c=1);a=e}else if((o=(u=p.n<0)?i:t.call(n,p))!==s)break}catch(t){a=e,c=1,i=t}finally{d=1}}return{value:o,done:u}}}(t,a,c),!0),l}var s={};function d(){}function l(){}function u(){}o=Object.getPrototypeOf;var p=[][a]?o(o([][a]())):(n(o={},a,function(){return this}),o),m=u.prototype=d.prototype=Object.create(p);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,n(e,c,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=u,n(m,"constructor",u),n(u,"constructor",l),l.displayName="GeneratorFunction",n(u,c,"GeneratorFunction"),n(m),n(m,c,"Generator"),n(m,a,function(){return this}),n(m,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:b}})()}function n(e,t,o,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}n=function(e,t,o,r){function c(t,o){n(e,t,function(e){return this._invoke(t,o,e)})}t?a?a(e,t,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[t]=o:(c("next",0),c("throw",1),c("return",2))},n(e,t,o,r)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(t,n,o){return(n=function(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function c(e,t,n,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(o,r)}document.addEventListener("DOMContentLoaded",function(){var e=window.WooBetterData||{},n=e.cart_cep||"",o=x();n&&n!==o&&(function(){try{localStorage.removeItem("woo_better_calc_custom_cache")}catch(e){}}(),k(n),y(n,!0));var a=e.inputStyles.fontClass||"",i=!1,s='h1[class*="title"]',d="",l="",u="";function p(){var t=document.querySelector(".woo-better-button-current-style"),n=document.querySelector(".woo-better-input-current-style");t.disabled=!1,n.disabled=!1,t.textContent=l;var o=document.querySelector(".woo-better-current-postcode-block");o&&(o.style.display="flex"),n.style.backgroundColor=e.inputStyles.backgroundColor||"#fff",n.style.cursor="",t.style.backgroundColor=e.buttonStyles.backgroundColor||"#0073aa",t.style.cursor="";var r=document.querySelector(".woo-better-update-icon"),a=document.querySelector(".woo-better-update-icon-container");r&&r.classList.contains("spinning")&&setTimeout(function(){r.classList.remove("spinning"),a&&a.classList.remove("spinning-container")},800)}function m(t,n,o){var r=document.createElement("img");r.src=e.display_icon[n],r.alt=o,r.classList.add("woo-better-toggle-icon"),r.classList.add(e.iconColor||"black-icon"),t.appendChild(r)}!function(){var t=document.createElement("style"),n=e.inputStyles.backgroundColor||"#ffffff",o=function(e){e=e.replace("#","");var t=parseInt(e,16),n=(t>>16)-10,o=(t>>8&255)-10,r=(255&t)-10;return n=Math.max(0,Math.min(255,n)),o=Math.max(0,Math.min(255,o)),r=Math.max(0,Math.min(255,r)),"#".concat((n<<16|o<<8|r).toString(16).padStart(6,"0"))}(n),r="#007cba";switch(e.iconColor||"blue-icon"){case"black-icon":r="#000000";break;case"gray-icon":r="#666666";break;case"red-icon":r="#dc3545";break;case"pink-icon":r="#e91e63";break;case"green-icon":r="#28a745";break;default:r="#007cba"}var a="\n            .woo-better-info-block {\n                color: ".concat(e.inputStyles.color," !important;\n                border-radius: ").concat(e.inputStyles.borderRadius," !important;\n                padding: 0px !important;\n                margin: 20px 0px !important;\n                font-size: 14px !important;\n            }\n\n            .woo-better-current-postcode-block {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                padding: 15px;\n                border: 1px solid #ddd;\n                border-radius: 5px;\n                background-color: ").concat(o," !important;\n                min-width: 200px;\n            }\n\n            .woo-better-content-block {\n                margin-top: -3px;\n                padding: 0px 20px;\n                background-color: ").concat(n," !important;\n                border: none;\n                height: 0;\n                overflow: hidden;\n                transition: height 0.3s ease;\n                box-shadow: none;\n            }\n\n            .woo-better-content-block.expanded {\n                height: auto; \n                padding: 10px 20px;\n                border-bottom-right-radius: ").concat(e.inputStyles.borderRadius," !important;\n                border-bottom-left-radius: ").concat(e.inputStyles.borderRadius," !important;\n                border: ").concat(e.inputStyles.borderWidth," ").concat(e.inputStyles.borderStyle," ").concat(e.inputStyles.borderColor," !important;\n                border-top: 0px !important;\n            }\n\n            .woo-better-separator {\n                border: none;\n                border-top: 1px solid #e0e0e0;\n                margin: 15px 0;\n                opacity: 0.6;\n            }\n\n            .woo-better-update-section {\n                display: flex;\n                align-items: center;\n                gap: 12px;\n                margin-top: 10px;\n                padding: 10px 0;\n            }\n\n            .woo-better-update-icon-container {\n                flex-shrink: 0;\n                width: 44px;\n                height: 44px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                cursor: pointer;\n                border-radius: 50%;\n                border: none;\n                background: transparent;\n                padding: 0;\n                transition: background-color 0.3s ease;\n                outline: none;\n            }\n\n            .woo-better-update-icon-container:focus {\n                outline: none;\n                box-shadow: none;\n            }\n\n            .woo-better-update-icon-container:hover {\n                background-color: ").concat(r,"1a;\n            }\n\n            .woo-better-update-icon-container:hover .woo-better-update-icon {\n                opacity: 1;\n                transform: rotate(180deg);\n            }\n\n            .woo-better-update-icon {\n                width: 32px;\n                height: 32px;\n                opacity: 0.8;\n                transition: transform 0.3s ease, opacity 0.3s ease;\n            }\n\n            .woo-better-update-icon.spinning {\n                animation: woo-better-spin 1s linear infinite;\n                opacity: 1;\n            }\n\n            .woo-better-update-icon-container.spinning-container {\n                opacity: 0.8 !important;\n                cursor: not-allowed !important;\n            }\n\n            .woo-better-update-icon-container.spinning-container:hover {\n                background-color: transparent !important;\n            }\n\n            .woo-better-update-icon-container.spinning-container:hover .woo-better-update-icon {\n                transform: none !important;\n            }\n\n            @keyframes woo-better-spin {\n                from { transform: rotate(0deg); }\n                to { transform: rotate(360deg); }\n            }\n\n            .woo-better-update-text-container {\n                flex: 1;\n                line-height: 1.4;\n            }\n\n            .woo-better-update-date {\n                width: fit-content;\n                padding: 3px;\n                font-size: 13px;\n                font-weight: 600;\n                margin: 0 0 4px 0;\n                color: ").concat(e.inputStyles.color||"#333",";\n                opacity: 0.8;\n                transition: all 0.3s ease;\n            }\n\n            .woo-better-update-date.flash {\n                animation: woo-better-flash 2s ease-in-out;\n            }\n\n            @keyframes woo-better-flash {\n                0%, 100% { \n                    background-color: transparent;\n                }\n                20%, 80% { \n                    background-color: ").concat(r,"26;\n                    border-radius: 4px;\n                }\n            }\n\n            .woo-better-info-text {\n                font-size: 12px;\n                padding: 3px;\n                margin: 0;\n                color: ").concat(e.inputStyles.color||"#333",";\n                opacity: 0.7;\n                line-height: 1.3;\n            }\n        ");t.appendChild(document.createTextNode(a)),document.head.appendChild(t)}(),S()||(E(),L());var b=new MutationObserver(function(t,n){t.forEach(function(t){if("childList"===t.type){var o=function(){if("custom"===e.position)s=e.custom_position||'h1[class*="title"]';else{var t=e.position||"top";"middle"===t?s='div[class*="price"], p[class*="price"]':"bottom"===t&&(s='form[class*="cart"]')}return s}(),r=document.querySelector(o),c=document.querySelector(".wc-block-components-shipping-calculator-address"),d=document.querySelector(".woo-better-parent-container");if(r&&!i&&!c){i=!0,d&&d.remove();var p=function(){var e=document.createElement("div");return e.classList.add("woo-better-parent-container"),e}(),b=function(){var t=document.createElement("form");t.id="custom-postcode-form",t.style.marginTop="20px",t.style.padding="0px";var n=x();n&&"yes"===e.enable_search&&(t.style.display="none");var o=document.createElement("div");o.classList.add("woo-better-container-current-style");var r=document.createElement("div");r.classList.add("woo-better-input-button-group-current-style");var c=document.createElement("div");c.classList.add("woo-better-input-wrapper-current-style");var i=document.createElement("input");i.type="text",i.name="woo_better_custom_product_postcode",i.placeholder=e.placeholder||"Digite o CEP",i.classList.add("woo-better-input-current-style"),a&&i.classList.add(a),i.autocomplete="postal-code",n&&(i.value=n);var s=e.inputStyles||{};Object.keys(s).forEach(function(e){i.style[e]=s[e]}),i.addEventListener("input",function(e){var t=e.target.value;if((t=t.replace(/[^\d-]/g,"")).includes("-")){var n,o=t.split("-");o.length>2||o[0].length>5?t=o[0].slice(0,5)+"-"+(null===(n=o[1])||void 0===n?void 0:n.slice(0,3)):o[0].length<5&&(t=o[0])}t.length>5&&!t.includes("-")&&(t=t.slice(0,5)+"-"+t.slice(5)),t.length>9&&(t=t.slice(0,9)),e.target.value=t});var d=document.createElement("img");d.src=e.icon,d.alt="Ícone de entrega",d.classList.add("woo-better-icon-current-style"),d.classList.add(e.iconColor||"black-icon"),c.appendChild(i),c.appendChild(d);var u=document.createElement("button");u.type="submit",u.textContent="CONSULTAR",u.classList.add("woo-better-button-current-style"),a&&u.classList.add(a);var p=e.buttonStyles||{};Object.keys(p).forEach(function(e){u.style[e]=p[e]}),r.appendChild(c),r.appendChild(u),o.appendChild(r);var m=document.createElement("a");return m.href="https://buscacepinter.correios.com.br/app/endereco/index.php",m.textContent="Não sei meu CEP",m.classList.add("woo-better-link-current-style"),a&&m.classList.add(a),m.target="_blank",o.appendChild(m),t.appendChild(o),t.addEventListener("submit",function(t){t.preventDefault();var n=i.value.trim();if(/^\d{5}-\d{3}$/.test(n)){u.disabled=!0,i.disabled=!0,w(n,e.product_id);var o=document.querySelector(".woo-better-info-block"),r=v(),a=r[n]&&Object.keys(r[n]).length>0,c=o&&("block"===o.style.display||"block"===getComputedStyle(o).display);!o||a||c||(o.style.display="none"),l=u.textContent,u.textContent="";var s=document.createElement("span");s.classList.add("loading-icon"),u.appendChild(s),i.style.backgroundColor="#f0f0f0",i.style.cursor="not-allowed",u.style.backgroundColor="#ccc",u.style.cursor="not-allowed",y(n,!0)}else alert("Por favor, insira um CEP válido no formato XXXXX-XXX.")}),t}(),f=x(),h={product:{name:"*******",quantity:e.quantity,currency_symbol:"R$",currency_minor_unit:2},shipping_rates:[{id:"**********",label:"***********",cost:12.34}],postcode:"123456-789"};if(f){var _=w(f,e.product_id);_?(h={product:_.product,shipping_rates:_.shipping_rates||[],postcode:f},!0===_.digital&&(h.product.digital=!0,h.shipping_rates=[])):h.postcode=f}var S=function(t,n,o,r){var c=document.createElement("div");c.classList.add("woo-better-info-block"),c.classList.add(a),x();var i=t&&t.name&&"*******"!==t.name;c.style.display="none";var s=document.createElement("div");s.classList.add("woo-better-content-block"),s.style.display="none";var d=document.createElement("p"),l=document.createElement("img");l.src=e.details_icon.product,l.alt="Produto",l.classList.add("woo-better-icon"),l.classList.add(e.iconColor||"black-icon"),d.appendChild(l);var u=document.createTextNode(" Produto");d.appendChild(u),d.classList.add("woo-better-product-name"),a&&d.classList.add(a);var p=document.createElement("p"),b=document.createElement("img");b.src=e.details_icon.quantity,b.alt="Quantidade",b.classList.add("woo-better-icon"),b.classList.add(e.iconColor||"black-icon"),p.appendChild(b);var f=document.createTextNode(" Quantidade: ".concat(t.quantity));p.appendChild(f),p.classList.add("woo-better-product-quantity"),a&&p.classList.add(a);var h=document.createElement("div");h.classList.add("woo-better-shipping-methods");var g=document.createElement("p"),v=document.createElement("img");v.src=e.icon,v.alt="Entrega",v.classList.add("woo-better-icon"),v.classList.add(e.iconColor||"black-icon"),g.appendChild(v);var w=document.createTextNode(" Métodos de Entrega:");g.appendChild(w),h.appendChild(g);var _=document.createElement("ul");if(_.classList.add("woo-better-shipping-list"),!0===t.digital||Array.isArray(n)&&0===n.length&&t.digital){var S=document.createElement("li");a&&S.classList.add(a),S.textContent="Produto digital, não há taxas de envio.",_.appendChild(S)}else n.forEach(function(e){var n=document.createElement("li");a&&n.classList.add(a);var o=document.createElement("div");o.innerHTML=t.currency_symbol;var r=o.textContent||o.innerText||t.currency_symbol;n.innerHTML="<strong>".concat(r," ").concat(parseFloat(e.cost).toFixed(t.currency_minor_unit).replace(".",","),"</strong> - ").concat(e.label),_.appendChild(n)});h.appendChild(_);var L=document.createElement("hr");L.classList.add("woo-better-separator");var k=document.createElement("div");k.classList.add("woo-better-update-section");var C=document.createElement("button");C.type="button",C.classList.add("woo-better-update-icon-container"),C.title="Clique para atualizar os dados de frete";var E=document.createElement("img");E.src=e.update_icon.updates,E.alt="Atualizado",E.classList.add("woo-better-update-icon"),E.classList.add(e.iconColor||"black-icon"),C.addEventListener("click",function(){if(!E.classList.contains("spinning")){var e=x();e&&(E.classList.add("spinning"),C.classList.add("spinning-container"),y(e,!0))}}),C.appendChild(E);var T=document.createElement("div");T.classList.add("woo-better-update-text-container");var q,O=document.createElement("p");O.classList.add("woo-better-update-date"),q=i&&t.updated_at?new Date(t.updated_at).toLocaleString("pt-BR"):(new Date).toLocaleString("pt-BR"),O.textContent="Atualizado em ".concat(q);var j=document.createElement("p");j.classList.add("woo-better-info-text"),j.textContent="Valor de frete estimado para este item. No carrinho, será exibido o frete total da compra.",T.appendChild(O),T.appendChild(j),k.appendChild(C),k.appendChild(T),s.appendChild(d),s.appendChild(p),s.appendChild(h),s.appendChild(L),s.appendChild(k);var P=function(e,t){var n=document.createElement("div");n.classList.add("woo-better-current-postcode-block");var o=document.createElement("div");o.classList.add("woo-better-toggle-postcode-wrapper");var r=document.createElement("button");r.type="button",m(r,"up","Esconder detalhes de entrega"),r.classList.add("woo-better-toggle-button");var c=document.createElement("span");c.innerHTML="<strong>CEP</strong>: ".concat(e),c.classList.add("woo-better-current-postcode-text"),a&&c.classList.add(a),r.addEventListener("click",function(){var e=document.querySelector(".woo-better-content-block");e&&(e.classList.contains("expanded")?(e.style.height="".concat(e.scrollHeight,"px"),requestAnimationFrame(function(){e.style.height="0"}),e.classList.remove("expanded"),r.innerHTML="",m(r,"down","Exibir detalhes de entrega")):(e.style.height="".concat(e.scrollHeight,"px"),e.classList.add("expanded"),r.innerHTML="",m(r,"up","Esconder detalhes de entrega"),e.addEventListener("transitionend",function(){e.classList.contains("expanded")&&(e.style.height="".concat(e.scrollHeight,"px"))},{once:!0})))}),o.appendChild(r),o.appendChild(c);var i=document.createElement("button");return i.type="button",i.textContent="Alterar",i.classList.add("woo-better-change-postcode-button"),a&&i.classList.add(a),i.addEventListener("click",function(){var e=document.querySelector(".woo-better-info-block");e&&(e.style.display="none"),t.style.display="block"}),n.appendChild(o),n.appendChild(i),n}(o,r);return c.appendChild(P),c.appendChild(s),c}(h.product,h.shipping_rates,h.postcode,b);p.appendChild(b),p.appendChild(S),r.insertAdjacentElement("afterend",p),L=function(){var t=x();if(t){var o=document.querySelector(".woo-better-input-current-style");if(o&&(o.value=t,e.enable_search&&"yes"===e.enable_search)){var r=w(t,e.product_id);if(r){var a=document.querySelector(".woo-better-info-block");g(r,b,a,t)}else b.style.display="block","yes"===e.enable_search&&setTimeout(function(){var e=b.querySelector(".woo-better-button-current-style");e&&!e.disabled&&e.click()},100)}}n.disconnect()},(k=new FormData).append("action","wc_better_calc_get_nonce"),k.append("action_nonce","woo_better_register_product_address"),fetch(e.ajaxurl,{method:"POST",body:k}).then(function(e){return e.json()}).then(function(e){e.success&&e.data&&e.data.nonce&&(u=e.data.nonce),L()}).catch(function(){L()})}}var L,k})});function y(e){return f.apply(this,arguments)}function f(){var n;return n=t().m(function n(o){var r,a,c,i,s=arguments;return t().w(function(t){for(;;)switch(t.n){case 0:if(s.length>1&&void 0!==s[1]&&s[1]){t.n=1;break}if(!(r=w(o,e.product_id))){t.n=1;break}return setTimeout(function(){var e=document.querySelector(".woo-better-info-block"),t=document.querySelector("#custom-postcode-form");g(r,t,e,o),p()},300),t.a(2);case 1:return a=new AbortController,c=setTimeout(function(){return a.abort()},15e3),i="undefined"!=typeof wpApiSettings&&wpApiSettings.root?wpApiSettings.root+"lknwcbettershipping/v1/cep/?postcode=".concat(o):void 0!==e&&""!==e.wooUrl?e.wooUrl+"/wp-json/lknwcbettershipping/v1/cep/?postcode=".concat(o):"/wp-json/lknwcbettershipping/v1/cep/?postcode=".concat(o),t.n=2,fetch(i,{method:"GET",signal:a.signal,headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){if(clearTimeout(c),!0===t.status){d=o,addressData=t.address||"",stateData=t.state_sigla||"",cityData=t.city||"";var n=e.ajaxurl,r=new FormData;r.append("action","register_product_address"),r.append("product_id",e.product_id),r.append("shipping[address_1]",addressData),r.append("shipping[city]",cityData),r.append("shipping[state]",stateData),r.append("shipping[postcode]",d),r.append("shipping[country]","BR"),fetch(n,{method:"POST",headers:{nonce:u},body:r}).then(function(e){return e.json()}).then(function(e){if(e.success){var t=document.querySelector(".woo-better-info-block"),n=document.querySelector("#custom-postcode-form");h(e.data,n,t,o).then(function(){p()}).catch(function(e){p(),e&&e.includes&&e.includes("CEP")&&alert(e)})}else{var r=document.querySelector(".woo-better-info-block"),a=document.querySelector("#custom-postcode-form");h(e.data,a,r,o).then(function(){p()}).catch(function(t){p();var n=e.data.message||"Erro ao processar as taxas de envio.";n.toLowerCase().includes("cep")&&alert(n)})}}).catch(function(e){e.message&&e.message.toLowerCase().includes("cep")&&alert(e.message),p()})}else p(),t.message&&t.message.toLowerCase().includes("cep")&&alert("Houve um erro ao consultar o CEP.")}).catch(function(e){p(),clearTimeout(c),"AbortError"===e.name||e.message&&!e.message.toLowerCase().includes("fetch")&&alert("Erro na consulta do CEP. Tente novamente.")});case 2:return t.a(2)}},n)}),f=function(){var e=this,t=arguments;return new Promise(function(o,r){var a=n.apply(e,t);function i(e){c(a,o,r,i,s,"next",e)}function s(e){c(a,o,r,i,s,"throw",e)}i(void 0)})},f.apply(this,arguments)}function h(t,n,o,a){return new Promise(function(c,i){try{var s=t;if(!0===s.digital){var d={product:{name:s.product_name,quantity:e.quantity||1,currency_symbol:"R$",currency_minor_unit:2,updated_at:(new Date).toISOString()},shipping_rates:[],digital:!0,message:s.message||"Produto digital, não há taxas de envio."};_(a,e.product_id,d),k(a);var l=o.querySelector(".woo-better-content-block"),u=o.querySelector(".woo-better-product-name");if(u){var p=u.childNodes[1];p&&p.nodeType===Node.TEXT_NODE&&(p.textContent=" Produto: ".concat(s.product_name))}var b=l.querySelector(".woo-better-shipping-list");b&&(b.innerHTML="<li>Produto digital, não há taxas de envio.</li>");var y=o.querySelector(".woo-better-current-postcode-text");y&&(y.innerHTML="<strong>CEP</strong>: ".concat(a));var f=o.querySelector(".woo-better-update-date");if(f){var h=(new Date).toLocaleString("pt-BR");f.textContent="Atualizado em ".concat(h),f.classList.remove("flash"),f.offsetWidth,f.classList.add("flash"),setTimeout(function(){f.classList.remove("flash")},2e3)}n.style.display="none",o.style.display="block";var g=o.querySelector(".woo-better-toggle-button");return g&&(g.innerHTML="",m(g,"up","Esconder detalhes de entrega")),l&&(l.classList.add("expanded"),l.style.display="block"),c()}if(!s||!Array.isArray(s.shipping_rates)||0===s.shipping_rates.length){var v=o.querySelector(".woo-better-content-block");if(v){v.classList.contains("expanded")&&(v.classList.remove("expanded"),v.style.height=""),Array.from(v.children).forEach(function(e){e.style.display="none"});var w=o.querySelector(".woo-better-current-postcode-text");w&&(w.innerHTML="<strong>CEP</strong>: ".concat(a));var S=v.querySelector(".woo-better-error-message");S?S.style.display="block":((S=document.createElement("p")).className="woo-better-error-message",S.style.color="#222",S.style.fontWeight="600",S.style.padding="12px 0",S.textContent="Nenhum método de frete disponível para o CEP informado.",v.appendChild(S)),v.style.display="block",v.classList.add("expanded")}return o.style.display="block",n.style.display="none",i("Nenhuma taxa de envio foi encontrada.")}var L=r(r({},s),{},{product:r(r({},s.product),{},{updated_at:(new Date).toISOString()})});_(a,e.product_id,L),k(a),n.style.display="none",o.style.display="block";var x=o.querySelector(".woo-better-content-block"),C=x.querySelector(".woo-better-shipping-list"),E=o.querySelector(".woo-better-product-name");if(E){var T=E.childNodes[1];T&&T.nodeType===Node.TEXT_NODE&&(T.textContent=" Produto: ".concat(s.product.name))}var q=o.querySelector(".woo-better-product-quantity");if(q){var O=q.childNodes[1];O&&O.nodeType===Node.TEXT_NODE&&(O.textContent=" Quantidade: ".concat(s.product.quantity))}if(x){var j=x.querySelector(".woo-better-error-message");j&&j.remove(),Array.from(x.children).forEach(function(e){e.classList.contains("woo-better-update-section")?e.style.display="flex":e.style.display="block"})}C.innerHTML="",s.shipping_rates.forEach(function(e){var t=document.createElement("li"),n=parseFloat(e.cost).toFixed(s.product.currency_minor_unit).replace(".",","),o=document.createElement("div");o.innerHTML=s.product.currency_symbol;var r=o.textContent||o.innerText||s.product.currency_symbol;t.innerHTML="<strong>".concat(r," ").concat(n,"</strong> - ").concat(e.label),C.appendChild(t)});var P=o.querySelector(".woo-better-current-postcode-text");P&&(P.innerHTML="<strong>CEP</strong>: ".concat(a));var D=o.querySelector(".woo-better-update-date");if(D){var N=s.product.updated_at?new Date(s.product.updated_at).toLocaleString("pt-BR"):(new Date).toLocaleString("pt-BR");D.textContent="Atualizado em ".concat(N),D.classList.remove("flash"),D.offsetWidth,D.classList.add("flash"),setTimeout(function(){D.classList.remove("flash")},2e3)}var M=o.querySelector(".woo-better-update-icon"),H=o.querySelector(".woo-better-update-icon-container");if(M&&M.classList.contains("spinning")&&setTimeout(function(){M.classList.remove("spinning"),H&&H.classList.remove("spinning-container")},800),x){var I=o.querySelector(".woo-better-toggle-button");I&&(I.innerHTML="",m(I,"up","Esconder detalhes de entrega")),x.classList.add("expanded"),x.style.display="block"}c()}catch(e){i(e)}})}function g(t,n,o,r){try{var a=t;n.style.display="none",k(r);var c=document.querySelector(".woo-better-current-postcode-block");c&&(c.style.display="flex");var i=o.querySelector(".woo-better-content-block").querySelector(".woo-better-shipping-list"),s=o.querySelector(".woo-better-product-name");if(s){var d=s.childNodes[1];d&&d.nodeType===Node.TEXT_NODE&&(d.textContent=" Produto: ".concat(a.product.name))}var l=o.querySelector(".woo-better-product-quantity");if(l){var u=l.childNodes[1];u&&u.nodeType===Node.TEXT_NODE&&(u.textContent=" Quantidade: ".concat(a.product.quantity))}!0===a.digital?i.innerHTML="<li>Produto digital, não há taxas de envio.</li>":(i.innerHTML="",a.shipping_rates.forEach(function(e){var t=document.createElement("li"),n=parseFloat(e.cost).toFixed(a.product.currency_minor_unit).replace(".",","),o=document.createElement("div");o.innerHTML=a.product.currency_symbol;var r=o.textContent||o.innerText||a.product.currency_symbol;t.innerHTML="<strong>".concat(r," ").concat(n,"</strong> - ").concat(e.label),i.appendChild(t)})),o.querySelector(".woo-better-current-postcode-text").innerHTML="<strong>CEP</strong>: ".concat(r);var p,b=o.querySelector(".woo-better-update-date");b&&(p=a.product&&a.product.updated_at?new Date(a.product.updated_at).toLocaleString("pt-BR"):a.timestamp?new Date(a.timestamp).toLocaleString("pt-BR"):(new Date).toLocaleString("pt-BR"),b.textContent="Atualizado em ".concat(p));var y=o.querySelector(".woo-better-update-icon"),f=o.querySelector(".woo-better-update-icon-container");y&&y.classList.contains("spinning")&&setTimeout(function(){y.classList.remove("spinning"),f&&f.classList.remove("spinning-container")},800),o.style.display="block";var h=o.querySelector(".woo-better-toggle-button");h&&(h.innerHTML="",m(h,"up","Esconder detalhes de entrega"));var g=o.querySelector(".woo-better-content-block");g&&!g.classList.contains("expanded")?(g.style.height="0",g.style.display="block",g.offsetHeight,g.classList.add("expanded"),g.style.height="".concat(g.scrollHeight,"px"),g.addEventListener("transitionend",function(){g.classList.contains("expanded")&&(g.style.height="auto")},{once:!0})):g&&g.classList.contains("expanded")&&(g.style.height="auto",g.style.display="block")}catch(t){var w=v();w[r]&&w[r][e.product_id]&&(delete w[r][e.product_id],localStorage.setItem("woo_better_product_cache",JSON.stringify(w)))}}function v(){var t="woo_better_product_cache",n=localStorage.getItem(t);if(n)try{var o=JSON.parse(n);if(!S())return localStorage.removeItem(t),{};var r=parseInt(e.cache_time)||0;if(r>0){var a=60*r*1e3,c=!1;Object.keys(o).forEach(function(e){Object.keys(o[e]).forEach(function(t){Date.now()-o[e][t].timestamp>a&&(delete o[e][t],c=!0)}),0===Object.keys(o[e]).length&&(delete o[e],c=!0)}),c&&localStorage.setItem(t,JSON.stringify(o))}return o}catch(e){return localStorage.removeItem(t),{}}return{}}function w(e,t){var n=v();return n[e]&&n[e][t]?n[e][t]:null}function _(e,t,n){var o=v();o[e]||(o[e]={});var r={product:n.product,shipping_rates:n.shipping_rates,timestamp:Date.now()};!0===n.digital&&(r.digital=!0),o[e][t]=r,localStorage.setItem("woo_better_product_cache",JSON.stringify(o))}function S(){var t=e.cache_token||"";return C().token===t}function L(){var t=e.cache_token||"",n=C();n.token=t,n.last_token_update=Date.now(),localStorage.setItem("woo_better_token_cache_data",JSON.stringify(n))}function x(){if(!S())return E(),null;var t=S()&&C().shared_postcode||null;if(t)return t;var n=parseInt(e.cache_time)||0;if(0===n){var o=v(),r=Object.keys(o);return r.length>0?r[0]:null}for(var a=v(),c=60*n*1e3,i=0,s=Object.keys(a);i<s.length;i++)for(var d=s[i],l=0,u=Object.keys(a[d]);l<u.length;l++){var p=u[l];if(Date.now()-a[d][p].timestamp<c)return d}return null}function k(e){!function(e){var t=C();t.shared_postcode=e,t.last_updated=Date.now();localStorage.setItem("woo_better_token_cache_data",JSON.stringify(t))}(e),L()}function C(){var e=localStorage.getItem("woo_better_token_cache_data");if(e)try{return JSON.parse(e)}catch(e){return{}}return{}}function E(){localStorage.removeItem("woo_better_product_cache"),localStorage.removeItem("woo_better_cart_cache"),localStorage.removeItem("woo_better_token_cache_data"),localStorage.removeItem("woo_better_token_cache"),localStorage.removeItem("woo_better_postcode_cache"),localStorage.removeItem("woo_better_last_postcode"),localStorage.removeItem("woo_better_cart_postcode_cache_simple")}b.observe(document.body,{childList:!0,subtree:!0})})})();