/*! For license information please see WcBetterShippingCalculatorForBrazilCustomCartPostcode.COMPILED.js.LICENSE.txt */
(()=>{function t(){var n,o,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function c(t,r,a,i){var c=r&&r.prototype instanceof l?r:l,d=Object.create(c.prototype);return e(d,"_invoke",function(t,e,r){var a,i,c,l=0,d=r||[],u=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return a=t,i=0,c=n,p.n=e,s}};function y(t,e){for(i=t,c=e,o=0;!u&&l&&!r&&o<d.length;o++){var r,a=d[o],y=p.p,m=a[2];t>3?(r=m===e)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=y&&((r=t<2&&y<a[1])?(i=0,p.v=e,p.n=a[1]):y<m&&(r=t<3||a[0]>e||e>m)&&(a[4]=t,a[5]=e,p.n=m,i=0))}if(r||t>1)return s;throw u=!0,e}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&y(d,m),i=d,c=m;(o=i<2?n:c)||!u;){a||(i?i<3?(i>1&&(p.n=-1),y(i,c)):p.n=c:p.v=c);try{if(l=2,a){if(i||(r="next"),o=a[r]){if(!(o=o.call(a,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,i<2&&(i=0)}else 1===i&&(o=a.return)&&o.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=n}else if((o=(u=p.n<0)?c:t.call(e,p))!==s)break}catch(t){a=n,i=1,c=t}finally{l=1}}return{value:o,done:u}}}(t,a,i),!0),d}var s={};function l(){}function d(){}function u(){}o=Object.getPrototypeOf;var p=[][a]?o(o([][a]())):(e(o={},a,function(){return this}),o),y=u.prototype=l.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,e(t,i,"GeneratorFunction")),t.prototype=Object.create(y),t}return d.prototype=u,e(y,"constructor",u),e(u,"constructor",d),d.displayName="GeneratorFunction",e(u,i,"GeneratorFunction"),e(y),e(y,i,"Generator"),e(y,a,function(){return this}),e(y,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m}})()}function e(t,n,o,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}e=function(t,n,o,r){function i(n,o){e(t,n,function(t){return this._invoke(n,o,t)})}n?a?a(t,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):t[n]=o:(i("next",0),i("throw",1),i("return",2))},e(t,n,o,r)}function n(t,e,n,o,r,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(o,r)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,a,i,c=[],s=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=a.call(n)).done)&&(c.push(o.value),c.length!==e);s=!0);}catch(t){l=!0,r=t}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw r}}return c}}(t,e)||r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}document.addEventListener("DOMContentLoaded",function(){var e=window.WooBetterData||{},a=e.inputStyles.fontClass||"",i=e.cart_cep||"",c=M();i&&i!==c&&(q(),H(i),setTimeout(function(){var t=document.querySelector("#custom-postcode-form");if(t){var e=t.querySelector(".woo-better-input-current-style"),n=t.querySelector(".woo-better-button-current-style");e&&n?(e.value=i,n.click()):_(i,!0)}else _(i,!0)},500));var s=!1,l='h2[class*="order"]',d="",u="",p="",y=null,m=!1;function f(){var t=document.querySelector(".woo-better-button-current-style"),n=document.querySelector(".woo-better-input-current-style");t&&(t.disabled=!1,t.textContent=u,t.style.backgroundColor=e.buttonStyles.backgroundColor||"#0073aa",t.style.cursor=""),n&&(n.disabled=!1,n.style.backgroundColor=e.inputStyles.backgroundColor||"#fff",n.style.cursor="");var o=document.querySelector(".woo-better-current-postcode-block");o&&(o.style.display="flex");var r=document.querySelector(".woo-better-update-icon"),a=document.querySelector(".woo-better-update-icon-container");r&&r.classList.contains("spinning")&&setTimeout(function(){r.classList.remove("spinning"),a&&a.classList.remove("spinning-container")},800)}function b(t,n,o){var r=document.createElement("img");r.src=e.display_icon[n],r.alt=o,r.classList.add("woo-better-toggle-icon"),r.classList.add(e.iconColor||"black-icon"),t.appendChild(r)}function h(){if(m)return l;var t,n,a,i=e.is_blocks_cart||!1;if(i?(a=window.fetch,window.fetch=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0],r=e[1];return"string"==typeof o&&o.includes("/wp-json/wc/store/v1/batch")&&function(t){try{return!!t&&!(!(e="string"==typeof t?JSON.parse(t):t).requests||!Array.isArray(e.requests))&&e.requests.some(function(t){return t.path&&(t.path.includes("update-item")||t.path.includes("remove-item"))});var e}catch(t){return!1}}(null==r?void 0:r.body)?a.apply(this,e).then(function(t){return setTimeout(function(){v()},500),t}).catch(function(t){return Promise.reject(t)}):a.apply(this,e)}):(t=XMLHttpRequest.prototype.open,n=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.open=function(e,n){this._url=n,this._method=e;for(var o=arguments.length,r=new Array(o>2?o-2:0),a=2;a<o;a++)r[a-2]=arguments[a];return t.call.apply(t,[this,e,n].concat(r))},XMLHttpRequest.prototype.send=function(){for(var t=this,e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return function(t,e,n){try{if(!e)return!1;if("POST"===t&&e.includes("/cart-old/")&&n){var a="";if(n instanceof FormData){var i,c=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=r(t))){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==e.return||e.return()}finally{if(c)throw a}}}}(n.entries());try{for(c.s();!(i=c.n()).done;){var s=o(i.value,2),l=s[0];if(s[1],l.includes("cart[")&&l.includes("][qty]"))return!0;if("update_cart"===l)return!0}}catch(t){c.e(t)}finally{c.f()}}else"string"==typeof n&&(a=n);if(a.includes("cart[")&&a.includes("[qty]"))return!0;if(a.includes("update_cart")||a.includes("woocommerce-cart-nonce"))return!0}return!("GET"!==t||!e.includes("remove_item=")||!e.includes("_wpnonce="))}catch(t){return!1}}(this._method,this._url,a[0])&&this.addEventListener("loadend",function(){t.status>=200&&t.status<400&&setTimeout(function(){v()},500)}),n.apply(this,a)},document.addEventListener("click",function(t){var e=t.target.closest("a");e&&e.href&&e.href.includes("remove_item=")&&e.href.includes("_wpnonce=")&&setTimeout(function(){v()},1e3)})),m=!0,"custom"===e.position)l=e.custom_position||(i?'h2[class*="order"]':".woocommerce-notices-wrapper");else{var c=e.position||"top";l=i?"middle"===c?".wp-block-woocommerce-cart-order-summary-coupon-form-block":"bottom"===c?".wp-block-woocommerce-cart-order-summary-block":'h2[class*="order"]':"middle"===c?'div[class*="cart_totals"]':"bottom"===c?".shop_table_responsive:not(.cart)":".cart_totals h2"}return l}function v(){y&&clearTimeout(y),y=setTimeout(function(){y=null,q();var t=M(),n=document.querySelector(".woo-better-info-block"),o=document.querySelector("#custom-postcode-form");if(t&&n&&o){n.style.display="none",o.style.display="block";var r=o.querySelector(".woo-better-input-current-style");r&&(r.value=t),setTimeout(function(){if(t&&"yes"===e.enable_search){var n=E(t);if(n){var r=document.querySelector(".woo-better-info-block");r&&k(n,o,r,t)}else{var a=o.querySelector(".woo-better-button-current-style");if(a&&!a.disabled){a.disabled=!1;try{a.click()}catch(t){var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});a.dispatchEvent(i)}}}}},100)}},300)}function g(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.querySelector(".woo-better-update-date");if(n){var o=(new Date).toLocaleString("pt-BR");n.textContent="Atualizado em ".concat(o),e&&(n.classList.remove("flash"),n.offsetWidth,n.classList.add("flash"),setTimeout(function(){n.classList.remove("flash")},2e3))}}!function(){var t=document.createElement("style"),n=e.inputStyles.backgroundColor||"#ffffff",o=function(t){t=t.replace("#","");var e=parseInt(t,16),n=(e>>16)-10,o=(e>>8&255)-10,r=(255&e)-10;return n=Math.max(0,Math.min(255,n)),o=Math.max(0,Math.min(255,o)),r=Math.max(0,Math.min(255,r)),"#".concat((n<<16|o<<8|r).toString(16).padStart(6,"0"))}(n),r="#007cba";switch(e.iconColor||"blue-icon"){case"black-icon":r="#000000";break;case"gray-icon":r="#666666";break;case"red-icon":r="#dc3545";break;case"pink-icon":r="#e91e63";break;case"green-icon":r="#28a745";break;default:r="#007cba"}var a="\n            .woo-better-info-block {\n                color: ".concat(e.inputStyles.color," !important;\n                border-radius: ").concat(e.inputStyles.borderRadius," !important;\n                padding: 0px !important;\n                margin: 20px 0px !important;\n                font-size: 14px !important;\n            }\n\n            .woo-better-current-postcode-block {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                padding: 15px;\n                border: 1px solid #ddd;\n                border-radius: 5px;\n                background-color: ").concat(o," !important;\n                min-width: 200px;\n            }\n\n            .woo-better-content-block {\n                margin-top: -3px;\n                padding: 0px 20px;\n                background-color: ").concat(n," !important;\n                border: none;\n                height: 0;\n                overflow: hidden;\n                transition: height 0.3s ease;\n                box-shadow: none;\n            }\n\n            .woo-better-content-block.expanded {\n                height: auto; \n                padding: 10px 20px;\n                border-bottom-right-radius: ").concat(e.inputStyles.borderRadius," !important;\n                border-bottom-left-radius: ").concat(e.inputStyles.borderRadius," !important;\n                border: ").concat(e.inputStyles.borderWidth," ").concat(e.inputStyles.borderStyle," ").concat(e.inputStyles.borderColor," !important;\n                border-top: 0px !important;\n            }\n\n            .woo-better-separator {\n                border: none;\n                border-top: 1px solid #e0e0e0;\n                margin: 15px 0;\n                opacity: 0.6;\n            }\n\n            .woo-better-update-section {\n                display: flex;\n                align-items: center;\n                gap: 12px;\n                margin-top: 10px;\n                padding: 10px 0;\n            }\n\n            .woo-better-update-icon-container {\n                flex-shrink: 0;\n                width: 44px;\n                height: 44px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                cursor: pointer;\n                border-radius: 50%;\n                border: none;\n                background: transparent;\n                padding: 0;\n                transition: background-color 0.3s ease;\n                outline: none;\n            }\n\n            .woo-better-update-icon-container:focus {\n                outline: none;\n                box-shadow: none;\n            }\n\n            .woo-better-update-icon-container:hover {\n                background-color: ").concat(r,"1a;\n            }\n\n            .woo-better-update-icon-container:hover .woo-better-update-icon {\n                opacity: 1;\n                transform: rotate(180deg);\n            }\n\n            .woo-better-update-icon {\n                width: 32px;\n                height: 32px;\n                opacity: 0.8;\n                transition: transform 0.3s ease, opacity 0.3s ease;\n                pointer-events: none;\n            }\n\n            .woo-better-update-icon.spinning {\n                animation: woo-better-spin 1s linear infinite;\n                opacity: 1;\n            }\n\n            .woo-better-update-icon-container.spinning-container {\n                opacity: 0.8 !important;\n                cursor: not-allowed !important;\n            }\n\n            .woo-better-update-icon-container.spinning-container:hover {\n                background-color: transparent !important;\n            }\n\n            .woo-better-update-icon-container.spinning-container:hover .woo-better-update-icon {\n                transform: none !important;\n            }\n\n            @keyframes woo-better-spin {\n                from { transform: rotate(0deg); }\n                to { transform: rotate(360deg); }\n            }\n\n            .woo-better-update-text-container {\n                flex: 1;\n                line-height: 1.4;\n            }\n\n            .woo-better-update-date {\n                width: fit-content;\n                padding: 3px;\n                font-size: 13px;\n                font-weight: 600;\n                margin: 0 0 4px 0;\n                color: ").concat(e.inputStyles.color||"#333",";\n                opacity: 0.8;\n                transition: all 0.3s ease;\n            }\n\n            .woo-better-update-date.flash {\n                animation: woo-better-flash 2s ease-in-out;\n            }\n\n            @keyframes woo-better-flash {\n                0%, 100% { \n                    background-color: transparent;\n                }\n                20%, 80% { \n                    background-color: ").concat(r,"26;\n                    border-radius: 4px;\n                }\n            }\n\n            .woo-better-info-text {\n                font-size: 12px;\n                padding: 3px;\n                margin: 0;\n                color: ").concat(e.inputStyles.color||"#333",";\n                opacity: 0.7;\n                line-height: 1.3;\n            }\n        ");t.appendChild(document.createTextNode(a)),document.head.appendChild(t)}(),I()||(D(),O()),setTimeout(function(){if(!s){var t=h();if(document.querySelector(t)){var e=new Event("DOMContentLoaded");document.dispatchEvent(e)}}},1e3);var w=new MutationObserver(function(t,e){t.forEach(function(t){if("childList"===t.type){var n=h();document.querySelector(n)&&!s&&(N(),e.disconnect())}})});function _(t){return S.apply(this,arguments)}function S(){var o;return o=t().m(function n(o){var r,a,i,c,s,l,u,y,m=arguments;return t().w(function(t){for(;;)switch(t.n){case 0:if(r=m.length>1&&void 0!==m[1]&&m[1],a=T(),r){t.n=1;break}if(!(i=E(o))){t.n=1;break}return setTimeout(function(){var t=document.querySelector(".woo-better-info-block"),e=document.querySelector("#custom-postcode-form");k(i,e,t,o),f()},300),t.a(2);case 1:return c=document.querySelector(".woo-better-info-block"),s=c&&"block"===c.style.display,c&&!s?c.style.display="none":c&&s&&(l=c.querySelector(".woo-better-shipping-list"))&&(l.innerHTML="<li>Recalculando taxas de envio...</li>"),u=new AbortController,y=setTimeout(function(){return u.abort()},15e3),"undefined"!=typeof wpApiSettings&&wpApiSettings.root?apiUrl=wpApiSettings.root+"lknwcbettershipping/v1/cep/?postcode=".concat(o):void 0!==e&&""!==e.wooUrl?apiUrl=e.wooUrl+"/wp-json/lknwcbettershipping/v1/cep/?postcode=".concat(o):apiUrl="/wp-json/lknwcbettershipping/v1/cep/?postcode=".concat(o),t.n=2,fetch(apiUrl,{method:"GET",signal:u.signal,headers:{"Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(t){if(clearTimeout(y),!0===t.status){d=o,addressData=t.address||"",stateData=t.state_sigla||"",cityData=t.city||"";var n=e.ajaxurl,i=new FormData;i.append("action","register_cart_address"),i.append("shipping[address_1]",addressData),i.append("shipping[city]",cityData),i.append("shipping[state]",stateData),i.append("shipping[postcode]",d),i.append("shipping[country]","BR"),fetch(n,{method:"POST",headers:{nonce:p},body:i}).then(function(t){return t.json()}).then(function(t){if(t.success&&t.data&&t.data.digital){var e=document.querySelector(".woo-better-info-block"),n=document.querySelector("#custom-postcode-form");C(d,t.data,a),H(d),n&&(n.style.display="none");var i=e.querySelector(".woo-better-cart-quantity");if(i){var c=i.childNodes[1];c&&c.nodeType===Node.TEXT_NODE&&(c.textContent=" Quantidade: ".concat(t.data.cart_count))}if(e){var s=e.querySelector(".woo-better-current-postcode-text"),l=e.querySelector(".woo-better-shipping-list");s&&(s.innerHTML="<strong>CEP</strong>: ".concat(d)),l&&(l.innerHTML="<li>Produto digital, não há taxas de envio.</li>"),g(e,r),e.style.display="block";var u=e.querySelector(".woo-better-content-block");u&&(u.classList.add("expanded"),u.style.display="block");var p=e.querySelector(".woo-better-update-icon"),y=e.querySelector(".woo-better-update-icon-container");p&&p.classList.contains("spinning")&&setTimeout(function(){p.classList.remove("spinning"),y&&y.classList.remove("spinning-container")},800)}f()}else if(t.success&&t.data){var m=document.querySelector(".woo-better-info-block"),b=document.querySelector("#custom-postcode-form");C(d,t.data,a),H(d),L(t.data,b,m,o,a).then(function(){f()}).catch(function(t){f(),t&&t.includes&&t.includes("CEP")&&alert(t)})}else{var h=t.data.message||"Erro ao processar as taxas de envio.";h.toLowerCase().includes("cep")&&alert(h),f()}}).catch(function(t){t.message&&t.message.toLowerCase().includes("cep")&&alert(t.message),f()})}else f(),t.message&&t.message.toLowerCase().includes("cep")&&alert("Houve um erro ao consultar o CEP.")}).catch(function(t){f(),clearTimeout(y),"AbortError"===t.name||t.message&&!t.message.toLowerCase().includes("fetch")&&alert("Erro na consulta do CEP. Tente novamente.")});case 2:return t.a(2)}},n)}),S=function(){var t=this,e=arguments;return new Promise(function(r,a){var i=o.apply(t,e);function c(t){n(i,r,a,c,s,"next",t)}function s(t){n(i,r,a,c,s,"throw",t)}c(void 0)})},S.apply(this,arguments)}function L(t,e,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new Promise(function(a,i){try{var c=t,s=n.querySelector(".woo-better-content-block");if(s){var l=s.querySelector(".woo-better-error-message");l&&l.remove()}if(!c||!Array.isArray(c.shipping_rates)||0===c.shipping_rates.length){if(s){s.classList.contains("expanded")&&(s.classList.remove("expanded"),s.style.height=""),Array.from(s.children).forEach(function(t){t.style.display="none"});var d=n.querySelector(".woo-better-current-postcode-text");d&&(d.innerHTML="<strong>CEP</strong>: ".concat(o));var u=s.querySelector(".woo-better-error-message");u?u.style.display="block":((u=document.createElement("p")).className="woo-better-error-message",u.style.color="#222",u.style.fontWeight="600",u.style.padding="12px 0",u.textContent="Nenhum método de frete disponível para o CEP informado.",s.appendChild(u)),s.style.display="block",s.classList.add("expanded")}return n.style.display="block",e.style.display="none",i("Nenhuma taxa de envio foi encontrada.")}if(C(o,c,r),H(o),s){var p=s.querySelector(".woo-better-error-message");p&&p.remove(),Array.from(s.children).forEach(function(t){t.classList.contains("woo-better-update-section")?t.style.display="flex":t.style.display="block"})}e.style.display="none",n.style.display="block";var y=s.querySelector(".woo-better-shipping-list"),m=n.querySelector(".woo-better-cart-quantity");if(m){var f=m.childNodes[1];f&&f.nodeType===Node.TEXT_NODE&&(f.textContent=" Quantidade: ".concat(c.cart.quantity))}y.innerHTML="",c.shipping_rates.forEach(function(t){var e=document.createElement("li"),n=parseFloat(t.cost).toFixed(c.cart.currency_minor_unit).replace(".",","),o=document.createElement("div");o.innerHTML=c.cart.currency_symbol;var r=o.textContent||o.innerText||c.cart.currency_symbol;e.innerHTML="<strong>".concat(r," ").concat(n,"</strong> - ").concat(t.label),y.appendChild(e)}),n.querySelector(".woo-better-current-postcode-text").innerHTML="<strong>CEP</strong>: ".concat(o);var h=n.querySelector(".woo-better-update-date");if(h){var v=(new Date).toLocaleString("pt-BR");h.textContent="Atualizado em ".concat(v),h.classList.remove("flash"),h.offsetWidth,h.classList.add("flash"),setTimeout(function(){h.classList.remove("flash")},2e3)}var g=n.querySelector(".woo-better-update-icon"),w=n.querySelector(".woo-better-update-icon-container");g&&g.classList.contains("spinning")&&setTimeout(function(){g.classList.remove("spinning"),w&&w.classList.remove("spinning-container")},800);var _=n.querySelector(".woo-better-toggle-button");_&&(_.innerHTML="",b(_,"up","Esconder detalhes de entrega")),s&&!s.classList.contains("expanded")?(s.style.height="",s.style.display="block",s.offsetHeight,s.classList.add("expanded"),s.style.height="".concat(s.scrollHeight,"px"),s.addEventListener("transitionend",function(){s.classList.contains("expanded")&&(s.style.height="auto")},{once:!0})):s&&s.classList.contains("expanded")&&(s.style.height="auto",s.style.display="block"),a()}catch(t){i(t)}})}function k(t,e,n,o){try{var r=t;e.style.display="none",H(o);var a=document.querySelector(".woo-better-current-postcode-block");a&&(a.style.display="flex");var i=n.querySelector(".woo-better-content-block").querySelector(".woo-better-shipping-list"),c=n.querySelector(".woo-better-cart-quantity");if(c){var s=c.childNodes[1];s&&s.nodeType===Node.TEXT_NODE&&(s.textContent=" Quantidade: ".concat(r.cart.quantity))}i.innerHTML="",!0===r.digital?i.innerHTML="<li>Produto digital, não há taxas de envio.</li>":r.shipping_rates.forEach(function(t){var e=document.createElement("li"),n=parseFloat(t.cost).toFixed(r.cart.currency_minor_unit).replace(".",","),o=document.createElement("div");o.innerHTML=r.cart.currency_symbol;var a=o.textContent||o.innerText||r.cart.currency_symbol;e.innerHTML="<strong>".concat(a," ").concat(n,"</strong> - ").concat(t.label),i.appendChild(e)}),n.querySelector(".woo-better-current-postcode-text").innerHTML="<strong>CEP</strong>: ".concat(o);var l,d=n.querySelector(".woo-better-update-date");d&&(l=r.timestamp?new Date(r.timestamp).toLocaleString("pt-BR"):(new Date).toLocaleString("pt-BR"),d.textContent="Atualizado em ".concat(l));var u=n.querySelector(".woo-better-update-icon"),p=n.querySelector(".woo-better-update-icon-container");u&&u.classList.contains("spinning")&&setTimeout(function(){u.classList.remove("spinning"),p&&p.classList.remove("spinning-container")},800),n.style.display="block";var y=n.querySelector(".woo-better-toggle-button");y&&(y.innerHTML="",b(y,"up","Esconder detalhes de entrega"));var m=n.querySelector(".woo-better-content-block");m&&!m.classList.contains("expanded")?(m.style.height="0",m.style.display="block",m.offsetHeight,m.classList.add("expanded"),m.style.height="".concat(m.scrollHeight,"px"),m.addEventListener("transitionend",function(){m.classList.contains("expanded")&&(m.style.height="auto")},{once:!0})):m&&m.classList.contains("expanded")&&(m.style.height="auto",m.style.display="block")}catch(t){var f=x();f[o]&&(delete f[o],localStorage.setItem("woo_better_cart_cache",JSON.stringify(f)))}}function q(){var t=M();if(t){var e=x();e[t]&&(delete e[t],localStorage.setItem("woo_better_cart_cache",JSON.stringify(e)))}}function x(){var t="woo_better_cart_cache",n=localStorage.getItem(t);if(n)try{var o=JSON.parse(n);if(!I())return localStorage.removeItem(t),{};var r=parseInt(e.cache_time)||0;if(r>0){var a=60*r*1e3,i=!1;Object.keys(o).forEach(function(t){Date.now()-o[t].timestamp>a&&(delete o[t],i=!0)}),i&&localStorage.setItem(t,JSON.stringify(o))}return o}catch(e){return localStorage.removeItem(t),{}}return{}}function E(t){var e=x(),n=T();if(e[t]){var o=e[t];if(A(n,o.cart_data))return o;delete e[t],localStorage.setItem("woo_better_cart_cache",JSON.stringify(e));var r=sessionStorage.getItem("woo_better_last_auto_click"),a=Date.now();return(!r||a-parseInt(r)>5e3)&&setTimeout(function(){var t=document.querySelector(".woo-better-button-current-style");t&&!t.disabled&&(sessionStorage.setItem("woo_better_last_auto_click",a.toString()),t.click())},100),null}return null}function C(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o="woo_better_cart_cache",r=x(),a=n||T();if(a&&0!==a.length){var i=e&&!0===e.digital;if(e&&(e.shipping_rates||i)){var c;c=i?{cart:{quantity:e.cart_count||1,currency_symbol:"R$",currency_minor_unit:2},shipping_rates:[],digital:!0,message:e.message,cart_data:a,timestamp:Date.now()}:{cart:e.cart,shipping_rates:e.shipping_rates,cart_data:a,timestamp:Date.now()},r[t]=c;try{localStorage.setItem(o,JSON.stringify(r)),localStorage.getItem(o)}catch(t){}}}}function T(){var t=[];if(window.wc&&window.wc.wcBlocksData&&window.wp&&window.wp.data)try{var n=window.wp.data.select("wc/store/cart");if(n){var o=n.getCartData?n.getCartData().items:n.getItems?n.getItems():null;o&&Array.isArray(o)&&o.length>0&&(t=o.map(function(t){var e=t.variation_id||t.variation||0;return Array.isArray(e)&&(e=e.length>0?e[0]:0),{id:t.id||t.product_id||t.key,quantity:parseInt(t.quantity)||1,variation_id:e}}))}}catch(t){}if(0===t.length&&window.wc&&window.wc.wcBlocksData&&window.wc.wcBlocksData.cartItems){var r=window.wc.wcBlocksData.cartItems;t=r.map(function(t){var e=t.variation_id||0;return Array.isArray(e)&&(e=e.length>0?e[0]:0),{id:t.id||t.product_id,quantity:parseInt(t.quantity)||1,variation_id:e}})}if(0===t.length&&window.wc_cart_fragments_params&&window.wc_cart_fragments_params.fragments){var a=window.wc_cart_fragments_params.fragments;Object.keys(a).forEach(function(e){var n=a[e];if("string"==typeof n){var o=document.createElement("div");o.innerHTML=n,o.querySelectorAll("[data-product-id], .cart-item, .wc-block-cart-items__row").forEach(function(e){var n,o=e.getAttribute("data-product-id")||e.getAttribute("data-key")||(null===(n=e.querySelector("[data-product-id]"))||void 0===n?void 0:n.getAttribute("data-product-id"));if(o){var r=e.querySelector('.qty, [name*="quantity"], .quantity'),a=r&&parseInt(r.value||r.textContent)||1,i=e.getAttribute("data-variation-id")||0;t.push({id:o,quantity:a,variation_id:i})}})}}),t.length}if(0===t.length){var i=[];[".wc-block-cart-items__row",".cart_item","tr.cart_item",'[class*="cart-item"]',".woocommerce-cart-form__cart-item"].forEach(function(t){var e=document.querySelectorAll(t);e.length>0&&(i=e)}),i.forEach(function(e,n){var o,r,a,i,c=e.getAttribute("data-product-id")||e.getAttribute("data-id")||(null===(o=e.querySelector("[data-product-id]"))||void 0===o?void 0:o.getAttribute("data-product-id"))||(null===(r=e.querySelector('input[name*="cart"]'))||void 0===r||null===(r=r.name.match(/cart\[([^\]]+)\]/))||void 0===r?void 0:r[1])||"product_".concat(n+1),s=null,l=1;if([".wc-block-components-quantity-selector__input",'input[name*="quantity"]',".qty","input.qty",".quantity input",'input[type="number"]'].forEach(function(t){s||(s=e.querySelector(t))}),s)l=parseInt(s.value)||1;else{var d=e.textContent.match(/(?:Qty|Quantidade|Qtd)[:\s]*(\d+)/i);d&&(l=parseInt(d[1])||1)}var u=e.getAttribute("data-variation-id")||(null===(a=e.querySelector("[data-variation-id]"))||void 0===a?void 0:a.getAttribute("data-variation-id"))||(null===(i=e.querySelector('input[name*="variation"]'))||void 0===i?void 0:i.value)||0;if(c){var p=u;Array.isArray(p)&&(p=p.length>0?p[0]:0);var y={id:c,quantity:l,variation_id:parseInt(p)||0};t.push(y)}})}if(0===t.length){var c=document.querySelectorAll('.cart-contents-count, .wc-block-mini-cart__badge, [class*="cart-count"], .cart-contents'),s=0;if(c.forEach(function(t){var e=parseInt(t.textContent)||0;e>s&&(s=e)}),s>0)t.push({id:"dom_fallback",quantity:s,variation_id:0});else if(e.quantity){var l=parseInt(e.quantity)||1;t.push({id:"unknown",quantity:l,variation_id:0})}}return t.reduce(function(t,e){return t+(parseInt(e.quantity)||0)},0),t.sort(function(t,e){return t.id!==e.id?t.id.toString().localeCompare(e.id.toString()):t.variation_id!==e.variation_id?t.variation_id-e.variation_id:t.quantity-e.quantity}),t}function A(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;if(t.reduce(function(t,e){return t+(parseInt(e.quantity)||0)},0)!==e.reduce(function(t,e){return t+(parseInt(e.quantity)||0)},0))return!1;if(1===t.length&&1===e.length){var n=t[0],o=e[0],r=parseInt(n.quantity)||0,a=parseInt(o.quantity)||0,i=function(t){return Array.isArray(t)?t.length>0?t[0]:0:parseInt(t)||0},c=i(n.variation_id),s=i(o.variation_id);return r===a&&c===s}for(var l=0;l<t.length;l++){var d=t[l],u=e[l],p=parseInt(d.quantity)||0,y=parseInt(u.quantity)||0,m=function(t){return Array.isArray(t)?t.length>0?t[0]:0:parseInt(t)||0},f=m(d.variation_id),b=m(u.variation_id);if(d.id!=u.id||p!==y||f!==b)return!1}return!0}function I(){var t=e.cache_token||"";return j().token===t}function O(){var t=e.cache_token||"",n=j();n.token=t,n.last_token_update=Date.now(),localStorage.setItem("woo_better_token_cache_data",JSON.stringify(n))}function M(){if(!I())return D(),null;var t=I()&&j().shared_postcode||null;if(t)return t;var n=parseInt(e.cache_time)||0;if(0===n){var o=x(),r=Object.keys(o);return r.length>0?r[0]:null}for(var a=x(),i=60*n*1e3,c=0,s=Object.keys(a);c<s.length;c++){var l=s[c];if(Date.now()-a[l].timestamp<i)return l}return null}function H(t){!function(t){var e=j();e.shared_postcode=t,e.last_updated=Date.now();localStorage.setItem("woo_better_token_cache_data",JSON.stringify(e))}(t),O()}function j(){var t=localStorage.getItem("woo_better_token_cache_data");if(t)try{return JSON.parse(t)}catch(t){return{}}return{}}function D(){localStorage.removeItem("woo_better_cart_cache"),localStorage.removeItem("woo_better_product_cache"),localStorage.removeItem("woo_better_token_cache_data"),localStorage.removeItem("woo_better_token_cache"),localStorage.removeItem("woo_better_cart_postcode_cache_simple"),localStorage.removeItem("woo_better_last_postcode"),localStorage.removeItem("woo_better_postcode_cache")}function q(){var t=x(),e=T();e&&0!==e.length&&(Object.keys(t).forEach(function(n){var o=t[n];A(e,o.cart_data)||delete t[n]}),Object.keys(t).length>0&&localStorage.setItem("woo_better_cart_cache",JSON.stringify(t)))}function N(){var t,n,o=h(),r=document.querySelector(o),i=document.querySelector(".woo-better-parent-container");if(r&&!i&&!s){s=!0;var c=function(){var t=document.createElement("div");return t.classList.add("woo-better-parent-container"),t}(),l=function(){var t=document.createElement("form");t.id="custom-postcode-form",t.style.marginTop="20px",t.style.padding="0px";var n=M();n&&"yes"===e.enable_search&&(t.style.display="none");var o=document.createElement("div");o.classList.add("woo-better-container-current-style");var r=document.createElement("div");r.classList.add("woo-better-input-button-group-current-style");var i=document.createElement("div");i.classList.add("woo-better-input-wrapper-current-style");var c=document.createElement("input");c.type="text",c.name="woo_better_custom_cart_postcode",c.placeholder=e.placeholder||"Digite o CEP",c.classList.add("woo-better-input-current-style"),a&&c.classList.add(a),c.autocomplete="postal-code",n&&(c.value=n);var s=e.inputStyles||{};Object.keys(s).forEach(function(t){c.style[t]=s[t]}),c.addEventListener("input",function(t){var e=t.target.value;if((e=e.replace(/[^\d-]/g,"")).includes("-")){var n,o=e.split("-");o.length>2||o[0].length>5?e=o[0].slice(0,5)+"-"+(null===(n=o[1])||void 0===n?void 0:n.slice(0,3)):o[0].length<5&&(e=o[0])}e.length>5&&!e.includes("-")&&(e=e.slice(0,5)+"-"+e.slice(5)),e.length>9&&(e=e.slice(0,9)),t.target.value=e});var l=document.createElement("img");l.src=e.icon,l.alt="Ícone de entrega",l.classList.add("woo-better-icon-current-style"),l.classList.add(e.iconColor||"black-icon"),i.appendChild(c),i.appendChild(l);var d=document.createElement("button");d.type="submit",d.textContent="CONSULTAR",d.classList.add("woo-better-button-current-style"),a&&d.classList.add(a);var p=e.buttonStyles||{};Object.keys(p).forEach(function(t){d.style[t]=p[t]}),r.appendChild(i),r.appendChild(d),o.appendChild(r);var y=document.createElement("a");return y.href="https://buscacepinter.correios.com.br/app/endereco/index.php",y.textContent="Não sei meu CEP",y.classList.add("woo-better-link-current-style"),a&&y.classList.add(a),y.target="_blank",o.appendChild(y),t.appendChild(o),t.addEventListener("submit",function(t){t.preventDefault();var e=c.value.trim();if(/^\d{5}-\d{3}$/.test(e)){d.disabled=!0,c.disabled=!0;var n=document.querySelector(".woo-better-info-block");n&&(n.style.display="none"),u=d.textContent,d.textContent="";var o=document.createElement("span");o.classList.add("loading-icon"),d.appendChild(o),c.style.backgroundColor="#f0f0f0",c.style.cursor="not-allowed",d.style.backgroundColor="#ccc",d.style.cursor="not-allowed",_(e,!0)}else alert("Por favor, insira um CEP válido no formato XXXXX-XXX.")}),t}(),d=M(),y={cart:{name:"****",quantity:e.quantity||1,currency_symbol:"R$",currency_minor_unit:2},shipping_rates:[{id:"**********",label:"***********",cost:12.34}],postcode:"12345-678"};if(d){var m=E(d);m?y={cart:m.cart,shipping_rates:m.shipping_rates,postcode:d}:y.postcode=d}var f=function(t,n,o,r){var i=document.createElement("div");i.classList.add("woo-better-info-block"),i.classList.add(a);var c=M(),s=t&&t.name&&"****"!==t.name;if(c&&"yes"===e.enable_search)if(s)i.style.display="block";else{var l=E(c);i.style.display=l?"block":"none"}else i.style.display="none";var d=document.createElement("div");d.classList.add("woo-better-content-block"),s?(d.style.display="block",d.classList.add("expanded")):d.style.display="none";var u=document.createElement("p"),p=document.createElement("img");p.src=e.details_icon.cart,p.alt="Produto",p.classList.add("woo-better-icon"),p.classList.add(e.iconColor||"black-icon"),u.appendChild(p);var y=document.createTextNode(" Carrinho");u.appendChild(y),u.classList.add("woo-better-cart-name"),a&&u.classList.add(a);var m=document.createElement("p"),f=document.createElement("img");f.src=e.details_icon.quantity,f.alt="Quantidade",f.classList.add("woo-better-icon"),f.classList.add(e.iconColor||"black-icon"),m.appendChild(f);var h=document.createTextNode(" Quantidade: ".concat(t.quantity));m.appendChild(h),m.classList.add("woo-better-cart-quantity"),a&&m.classList.add(a);var v=document.createElement("div");v.classList.add("woo-better-shipping-methods");var g=document.createElement("p"),w=document.createElement("img");w.src=e.icon,w.alt="Entrega",w.classList.add("woo-better-icon"),w.classList.add(e.iconColor||"black-icon"),g.appendChild(w);var S=document.createTextNode(" Métodos de Entrega:");g.appendChild(S),v.appendChild(g);var L=document.createElement("ul");L.classList.add("woo-better-shipping-list"),n.forEach(function(e){var n=document.createElement("li");a&&n.classList.add(a);var o=document.createElement("div");o.innerHTML=t.currency_symbol;var r=o.textContent||o.innerText||t.currency_symbol;n.innerHTML="<strong>".concat(r," ").concat(parseFloat(e.cost).toFixed(t.currency_minor_unit).replace(".",","),"</strong> - ").concat(e.label),L.appendChild(n)}),v.appendChild(L);var k=document.createElement("hr");k.classList.add("woo-better-separator");var x=document.createElement("div");x.classList.add("woo-better-update-section");var C=document.createElement("button");C.type="button",C.classList.add("woo-better-update-icon-container"),C.title="Clique para atualizar os dados de frete do carrinho";var T=document.createElement("img");T.src=e.update_icon.updates,T.alt="Atualizado",T.classList.add("woo-better-update-icon"),T.classList.add(e.iconColor||"black-icon"),C.addEventListener("click",function(){if(!T.classList.contains("spinning")){var t=M();t&&(T.classList.add("spinning"),C.classList.add("spinning-container"),q(),_(t,!0))}}),C.appendChild(T);var A=document.createElement("div");A.classList.add("woo-better-update-text-container");var I=document.createElement("p");I.classList.add("woo-better-update-date");var O=(new Date).toLocaleString("pt-BR");I.textContent="Atualizado em ".concat(O);var H=document.createElement("p");H.classList.add("woo-better-info-text"),H.textContent="Valor de frete calculado para todos os itens do carrinho.",A.appendChild(I),A.appendChild(H),x.appendChild(C),x.appendChild(A),d.appendChild(u),d.appendChild(m),d.appendChild(v),d.appendChild(k),d.appendChild(x);var j=function(t,e){var n=document.createElement("div");n.classList.add("woo-better-current-postcode-block");var o=document.createElement("div");o.classList.add("woo-better-toggle-postcode-wrapper");var r=document.createElement("button");r.type="button",b(r,"up","Esconder detalhes de entrega"),r.classList.add("woo-better-toggle-button");var i=document.createElement("span");i.innerHTML="<strong>CEP</strong>: ".concat(t),i.classList.add("woo-better-current-postcode-text"),a&&i.classList.add(a),r.addEventListener("click",function(){var t=document.querySelector(".woo-better-content-block");t&&(t.classList.contains("expanded")?(t.style.height="".concat(t.scrollHeight,"px"),requestAnimationFrame(function(){t.style.height="0"}),t.classList.remove("expanded"),r.innerHTML="",b(r,"down","Exibir detalhes de entrega")):(t.style.height="".concat(t.scrollHeight,"px"),t.classList.add("expanded"),r.innerHTML="",b(r,"up","Esconder detalhes de entrega"),t.addEventListener("transitionend",function(){t.classList.contains("expanded")&&(t.style.height="".concat(t.scrollHeight,"px"))},{once:!0})))}),o.appendChild(r),o.appendChild(i);var c=document.createElement("button");return c.type="button",c.textContent="Alterar",c.classList.add("woo-better-change-postcode-button"),a&&c.classList.add(a),c.addEventListener("click",function(){var t=document.querySelector(".woo-better-info-block");t&&(t.style.display="none"),e.style.display="block"}),n.appendChild(o),n.appendChild(c),n}(o,r);return i.appendChild(j),i.appendChild(d),i}(y.cart,y.shipping_rates,y.postcode,l);c.appendChild(l),c.appendChild(f),r.insertAdjacentElement("afterend",c),t=function(){var t=M();if(t){var n=document.querySelector(".woo-better-input-current-style");if(n&&(n.value=t,e.enable_search&&"yes"===e.enable_search)){var o=E(t);if(o){var r=document.querySelector(".woo-better-info-block");if(r){if(o.cart&&o.cart.name&&"****"!==o.cart.name){r.style.display="block";var a=r.querySelector(".woo-better-toggle-button");a&&(a.innerHTML="",b(a,"up","Esconder detalhes de entrega"));var i=r.querySelector(".woo-better-content-block");i&&(i.classList.add("expanded"),i.style.display="block",i.style.height="".concat(i.scrollHeight,"px"))}else{k(o,l,r,t),r.style.display="block";var c=r.querySelector(".woo-better-toggle-button");c&&(c.innerHTML="",b(c,"up","Esconder detalhes de entrega"));var s=r.querySelector(".woo-better-content-block");s&&(s.classList.add("expanded"),s.style.display="block",s.style.height="".concat(s.scrollHeight,"px"))}var d=r.querySelector(".woo-better-current-postcode-text");d&&(d.innerHTML="<strong>CEP</strong>: ".concat(t))}}else{l.style.display="block";var u=l.querySelector(".woo-better-input-current-style");u&&(u.value=t),setTimeout(function(){var t=l.querySelector(".woo-better-button-current-style");t&&"yes"===e.enable_search&&t.click()},300)}}}},(n=new FormData).append("action","wc_better_calc_get_nonce"),n.append("action_nonce","woo_better_register_cart_address"),fetch(e.ajaxurl,{method:"POST",body:n}).then(function(t){return t.json()}).then(function(e){e.success&&e.data&&e.data.nonce&&(p=e.data.nonce),t()}).catch(function(e){t()})}}setInterval(function(){var t=document.querySelector(".woo-better-parent-container"),e=document.querySelector(h());!t&&e&&s&&(s=!1,setTimeout(function(){N()},100))},500),w.observe(document.body,{childList:!0,subtree:!0})})})();