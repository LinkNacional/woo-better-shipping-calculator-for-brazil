document.addEventListener("DOMContentLoaded",function(){var e=!1,t=!1,n=null,i=null,o=null,l=!1,r={billing_persontype:"",billing_cpf:"",billing_cnpj:"",billing_document:"",billing_company:""};function a(e){var t=e.replace(/[^0-9]/g,"");if(11===t.length){var n=function(e){if(11!==(e=e.replace(/[^0-9]/g,"")).length)return!1;if(/^(\d)\1{10}$/.test(e))return!1;for(var t=0,n=0;n<9;n++)t+=parseInt(e[n])*(10-n);var i=11-t%11;if(i>=10&&(i=0),parseInt(e[9])!==i)return!1;t=0;for(var o=0;o<10;o++)t+=parseInt(e[o])*(11-o);var l=11-t%11;return l>=10&&(l=0),parseInt(e[10])===l}(t);return{isValid:n,type:"cpf",message:n?"":"CPF inválido. Verifique os números informados."}}if(14===t.length){var i=function(e){if(14!==(e=e.replace(/[^0-9]/g,"")).length)return!1;if(/^(\d)\1{13}$/.test(e))return!1;for(var t=[5,4,3,2,9,8,7,6,5,4,3,2],n=[6,5,4,3,2,9,8,7,6,5,4,3,2],i=0,o=0;o<12;o++)i+=parseInt(e[o])*t[o];var l=i%11;if(l=l<2?0:11-l,parseInt(e[12])!==l)return!1;i=0;for(var r=0;r<13;r++)i+=parseInt(e[r])*n[r];var a=i%11;return a=a<2?0:11-a,parseInt(e[13])===a}(t);return{isValid:i,type:"cnpj",message:i?"":"CNPJ inválido. Verifique os números informados."}}return{isValid:!1,type:null,message:"Documento deve ter 11 dígitos (CPF) ou 14 dígitos (CNPJ)."}}function c(){var e=document.querySelector("#billing-country")||document.querySelector('select[name="billing_country"]')||document.querySelector('input[name="billing_country"]');return!!e&&"BR"===e.value}function s(){var e=document.querySelector(".wc-better-billing-document"),t=document.querySelector(".wc-better-billing-company"),n=document.getElementById("billing-persontype"),i=document.getElementById("billing-cpf"),o=document.getElementById("billing-cnpj");e&&e.remove(),t&&t.remove(),n&&n.remove(),i&&i.remove(),o&&o.remove(),l=!1,function(){var e={billing_persontype:"",billing_cpf:"",billing_cnpj:"",billing_company:""};if("undefined"!=typeof wp&&wp.data&&wp.data.dispatch)try{var t=wp.data.dispatch;if(t("wc/store/checkout")){var n=t("wc/store/checkout");n.setExtensionData&&n.setExtensionData("woo_better_person_type",e)}}catch(e){}window.wc&&window.wc.blocksCheckout&&"function"==typeof window.wc.blocksCheckout.extensionCartUpdate&&window.wc.blocksCheckout.extensionCartUpdate({namespace:"woo_better_person_type",data:e})}()}function p(t){if(c()){var n=document.querySelector('span.wc-block-components-address-card__edit[aria-controls="billing"]');n&&("true"!=n.getAttribute("aria-expanded")&&n.click(),"true"==n.getAttribute("aria-expanded")&&(setTimeout(function(){!function(e){if(c()&&!document.getElementById("billing_document")){var t=e.querySelector("#billing-last_name");if(t){var n="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_persontype?WooBetterPersonTypeData.billing_persontype:"",i="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cpf?WooBetterPersonTypeData.billing_cpf:"",o="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cnpj?WooBetterPersonTypeData.billing_cnpj:"",a="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_company?WooBetterPersonTypeData.billing_company:"";r.billing_document?(n=r.billing_persontype,i=r.billing_cpf,o=r.billing_cnpj,a=r.billing_company):(r.billing_persontype=n,r.billing_cpf=i,r.billing_cnpj=o,r.billing_company=a,i?r.billing_document=i:o&&(r.billing_document=o));var s="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",p=("undefined"==typeof WooBetterPersonTypeConfig||WooBetterPersonTypeConfig.show_select,t.parentElement),v=r.billing_document||"",E=r.billing_persontype||"";E||(i?(v=i,E="physical"):o&&(v=o,E="legal")),function(e,t,n){var i=document.createElement("div");i.className="wc-block-components-text-input wc-block-components-address-form__document wc-better-billing-document";var o=document.createElement("input");o.type="text",o.id="billing_document",o.setAttribute("autocomplete","off"),o.setAttribute("aria-label","CPF/CNPJ"),o.setAttribute("aria-invalid","false"),o.setAttribute("autocapitalize","none"),o.value=t;var l="",a="";"physical"===n?(l="Digite seu CPF no formato 000.000.000-00",a="CPF"):"legal"===n?(l="Digite seu CNPJ no formato 00.000.000/0000-00",a="CNPJ"):(l="Digite seu CPF (000.000.000-00) ou CNPJ (00.000.000/0000-00)",a="CPF/CNPJ"),o.setAttribute("title",l);var c=t;o.addEventListener("input",function(){var e,t=u(this.value.replace(/\D/g,""),n);e="cpf"===t?h(this.value):"cnpj"===t?w(this.value):d(this.value,n),this.value=e,r.billing_document=e,e!==c&&(c=e,m(e,t),_(),f(e,n))});var s=document.createElement("label");s.setAttribute("for","billing_document"),s.textContent=a,i.appendChild(o),i.appendChild(s);var p=document.createElement("div");p.className="wc-block-components-validation-error wc-better-document-error",p.setAttribute("role","alert"),p.style.display="none";var b=document.createElement("p");b.id="validate-error-billing_document";var y=document.createElementNS("http://www.w3.org/2000/svg","svg");y.setAttribute("xmlns","http://www.w3.org/2000/svg"),y.setAttribute("viewBox","-2 -2 24 24"),y.setAttribute("width","24"),y.setAttribute("height","24"),y.setAttribute("aria-hidden","true"),y.setAttribute("focusable","false");var v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d","M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"),y.appendChild(v);var E=document.createElement("span");E.textContent="Por favor, insira um documento válido.",b.appendChild(y),b.appendChild(E),p.appendChild(b),i.appendChild(p),t&&i.classList.add("is-active"),o.addEventListener("focus",function(){i.classList.add("is-active")}),o.addEventListener("blur",function(){o.value||(i.classList.remove("is-active"),g("physical"===n?"Por favor insira um CPF válido":"legal"===n?"Por favor insira um CNPJ válido":"Por favor insira um CPF/CNPJ válido"))}),e.insertAdjacentElement("afterend",i)}(p,v,s);var P=document.querySelector(".wc-better-billing-document");P&&(p=P);var C=function(e,t,n){if("physical"!==n){var i=document.getElementById("billing-company"),o=i?i.closest(".wc-block-components-text-input"):null;if(i&&o&&(!t&&i.value&&(t=i.value),o.remove()),document.querySelector(".wc-better-billing-company"))return document.querySelector(".wc-better-billing-company");var l=document.createElement("div");l.className="wc-block-components-text-input wc-block-components-address-form__company wc-better-billing-company";var a="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cnpj?WooBetterPersonTypeData.billing_cnpj:"",c=r.billing_document||"",s=!1;a&&14===a.replace(/\D/g,"").length&&(s=!0),c&&!s&&14===c.replace(/\D/g,"").length&&(s=!0),l.style.display=s?"block":"none",l.style.borderColor="";var p=document.createElement("input");p.type="text",p.id="billing-company",p.name="billing_company",p.setAttribute("autocomplete","organization"),p.setAttribute("aria-label","Nome da Empresa"),p.setAttribute("aria-invalid","false"),p.setAttribute("autocapitalize","words"),p.value=t,p.style.borderColor="",s&&p.value&&p.value.trim()&&l.classList.add("is-active");var u=document.createElement("label");u.setAttribute("for","billing-company"),u.textContent="Nome da Empresa",l.appendChild(p),l.appendChild(u);var d=document.createElement("div");d.className="wc-block-components-validation-error wc-better-company-error",d.setAttribute("role","alert"),d.style.display="none";var m=document.createElement("p");m.id="validate-error-billing-company";var g=document.createElementNS("http://www.w3.org/2000/svg","svg");g.setAttribute("xmlns","http://www.w3.org/2000/svg"),g.setAttribute("viewBox","-2 -2 24 24"),g.setAttribute("width","24"),g.setAttribute("height","24"),g.setAttribute("aria-hidden","true"),g.setAttribute("focusable","false");var v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d","M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"),g.appendChild(v);var f=document.createElement("span");return f.textContent="Este campo é obrigatório.",m.appendChild(g),m.appendChild(f),d.appendChild(m),l.appendChild(d),t&&l.classList.add("is-active"),p.addEventListener("focus",function(){l.classList.add("is-active")}),p.addEventListener("blur",function(){p.value&&p.value.trim()?(y(),l.classList.remove("has-error"),p.style&&(p.style.borderColor=""),p.setAttribute("aria-invalid","false")):(l.classList.remove("is-active"),"block"===l.style.display&&(b("Este campo é obrigatório."),l.classList.add("has-error"),p.style&&(p.style.borderColor="#d63638"),p.setAttribute("aria-invalid","true")))}),p.addEventListener("input",function(){r.billing_company=p.value,_(),p.value&&p.value.trim()&&l.classList.add("is-active"),p.value&&p.value.trim()&&(y(),l.classList.remove("has-error"),p.style&&(p.style.borderColor=""),p.setAttribute("aria-invalid","false")),l.classList.remove("has-error"),p.style.borderColor="",p.setAttribute("aria-invalid","false")}),e.insertAdjacentElement("afterend",l),l}}(p,a,s);C&&(p=C);var B=document.createElement("input");B.type="hidden",B.id="billing-persontype",B.name="billing-persontype",B.value=E||function(e){return"physical"===e?"physical":"legal"===e?"legal":""}(s),p.insertAdjacentElement("afterend",B);var L=document.createElement("input");L.type="hidden",L.id="billing-cpf",L.name="billing-cpf",L.value=i,B.insertAdjacentElement("afterend",L);var T,D=document.createElement("input");D.type="hidden",D.id="billing-cnpj",D.name="billing-cnpj",D.value=o,L.insertAdjacentElement("afterend",D),(T=document.getElementById("billing_document"))&&T.addEventListener("blur",function(){var e="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",t=this.value.replace(/\D/g,""),n=u(t,e);"both"!==e||n&&("cpf"===n&&11===t.length||"cnpj"===n&&14===t.length)?this.setAttribute("required","true"):"both"===e&&this.removeAttribute("required")}),l=!0,v&&setTimeout(function(){var e=document.getElementById("billing_document");if(e){var t=new Event("input",{bubbles:!0});e.dispatchEvent(t)}},100),_(!0)}}}(t)},300),e=!0))}}function u(e,t){return"physical"===t?"cpf":"legal"===t?"cnpj":e.length>=11&&e.length<=11?"cpf":e.length>=14||e.length>11?"cnpj":null}function d(e,t){var n=e.replace(/\D/g,"");return"physical"===t?h(e):"legal"===t?w(e):n.length<=11?h(e):w(e)}function m(e,t){var n=document.getElementById("billing-persontype"),i=document.getElementById("billing-cpf"),o=document.getElementById("billing-cnpj"),l=document.getElementById("billing-company"),a=document.querySelector(".wc-better-billing-company");!a&&l&&(a=l.closest(".wc-block-components-text-input")||l.closest(".wc-better-company-controlled")||l.parentElement);var c=14===e.replace(/\D/g,"").length;if(a&&l&&(c?(a.style.display="block",r.billing_company&&!l.value&&function(e,t){if(e){Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set.call(e,t);var n=new Event("input",{bubbles:!0});e.dispatchEvent(n)}}(l,r.billing_company),l.value&&l.value.trim()?a.classList.add("is-active"):a.classList.remove("is-active")):(a.style.display="none",a.classList.remove("is-active"),a.classList.remove("has-error"),l.style&&(l.style.borderColor=""),l.setAttribute("aria-invalid","false"))),"cpf"===t)n&&(n.value="physical"),i&&(i.value=e),o&&(o.value=""),r.billing_persontype="physical",r.billing_cpf=e,r.billing_cnpj="";else if("cnpj"===t)n&&(n.value="legal"),i&&(i.value=""),o&&(o.value=e),r.billing_persontype="legal",r.billing_cpf="",r.billing_cnpj=e;else{var s="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both";"physical"===s?(n&&(n.value="physical"),i&&(i.value=e),o&&(o.value=""),r.billing_persontype="physical",r.billing_cpf=e,r.billing_cnpj=""):"legal"===s?(n&&(n.value="legal"),i&&(i.value=""),o&&(o.value=e),r.billing_persontype="legal",r.billing_cpf="",r.billing_cnpj=e):e.replace(/\D/g,"").length<=11?(i&&(i.value=e),o&&(o.value=""),r.billing_cpf=e,r.billing_cnpj=""):(i&&(i.value=""),o&&(o.value=e),r.billing_cpf="",r.billing_cnpj=e)}}function b(e){var t=document.querySelector(".wc-better-company-error"),n=document.querySelector(".wc-better-billing-company")||document.querySelector(".wc-better-company-controlled");if(t){var i=t.querySelector("span");i&&(i.textContent=e),t.style.display="block"}n&&n.classList.add("has-error")}function y(){var e=document.querySelector(".wc-better-company-error"),t=document.querySelector(".wc-better-billing-company")||document.querySelector(".wc-better-company-controlled");e&&(e.style.display="none"),t&&t.classList.remove("has-error")}function g(e){var t=document.querySelector(".wc-better-document-error"),n=document.querySelector(".wc-better-billing-document");if(t){var i=t.querySelector("span");i&&(i.textContent=e),t.style.display="block"}n&&n.classList.add("has-error")}function v(){var e=document.querySelector(".wc-better-document-error"),t=document.querySelector(".wc-better-billing-document");e&&(e.style.display="none"),t&&t.classList.remove("has-error")}function f(e,t){var n=e.replace(/\D/g,""),i=!1;e.length>0&&("physical"===t?i=11===n.length:"legal"===t?i=14===n.length:"both"===t&&(i=11===n.length||14===n.length)),i&&v()}function h(e){return e.replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1")}function w(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1")}function _(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c()&&(i&&(clearTimeout(i),i=null),e?E():i=setTimeout(function(){E(),i=null},1500))}function E(){if(c()){var e=document.getElementById("billing-persontype"),t=document.getElementById("billing-cpf"),n=document.getElementById("billing-cnpj"),i=document.getElementById("billing-company"),o={billing_persontype:e?e.value:"",billing_cpf:t?t.value:"",billing_cnpj:n?n.value:"",billing_company:i?i.value:""};if("undefined"!=typeof wp&&wp.data&&wp.data.dispatch)try{var l=wp.data.dispatch;if(l("wc/store/checkout")){var r=l("wc/store/checkout");r.setExtensionData&&r.setExtensionData("woo_better_person_type",o)}}catch(e){}window.wc&&window.wc.blocksCheckout&&"function"==typeof window.wc.blocksCheckout.extensionCartUpdate&&window.wc.blocksCheckout.extensionCartUpdate({namespace:"woo_better_person_type",data:o})}}new MutationObserver(function(e){var t=document.querySelector("#shipping-company");if(t){var n=t.closest(".wc-block-components-text-input");n&&(n.style.padding="0",n.style.margin="0",n.style.display="none")}}).observe(document.body,{childList:!0,subtree:!0}),new MutationObserver(function(i){if(c()){var r=document.querySelector("#billing");r||(e=!1),r&&!e&&p(r),document.querySelector("#billing-country")&&!o&&function(){var e=document.querySelector("#billing-country");if(e&&(e.dataset.personTypeListener||(e.addEventListener("change",function(){setTimeout(function(){if(c()){if(!l){var e=document.querySelector("#billing");e&&p(e)}}else l&&s()},300)}),e.dataset.personTypeListener="true"),!o)){o=new MutationObserver(function(e){e.forEach(function(e){"childList"!==e.type&&"attributes"!==e.type||setTimeout(function(){var e=document.querySelector("#billing-country");e&&!e.dataset.personTypeListener&&(e.addEventListener("change",function(){setTimeout(function(){if(c()){if(!l){var e=document.querySelector("#billing");e&&p(e)}}else l&&s()},300)}),e.dataset.personTypeListener="true")},100)})});var t=document.querySelector("#billing");t&&o.observe(t,{childList:!0,subtree:!0,attributes:!0})}}();var u=document.querySelector(".wc-block-checkout__actions_row");u&&(n=u.querySelector("button")),n&&!t&&(t=!0,n&&n.addEventListener("click",function(e){if(c()){document.getElementById("billing-persontype");var t=document.getElementById("billing_document");if(t){var n=t.value.trim(),i=n.replace(/\D/g,""),o="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",l=!1,r="";if(n.length){if("physical"===o)if(11===i.length){var s=a(i);s.isValid&&"cpf"===s.type?l=!0:r=s.message||"CPF inválido."}else r="Por favor, insira um CPF válido com 11 dígitos.";else if("legal"===o)if(14===i.length){var p=a(i);p.isValid&&"cnpj"===p.type?l=!0:r=p.message||"CNPJ inválido."}else r="Por favor, insira um CNPJ válido com 14 dígitos.";else if("both"===o)if(11===i.length||14===i.length){var u=a(i);u.isValid?l=!0:r=u.message||"Documento inválido."}else r="Por favor, insira um CPF completo (11 dígitos) ou CNPJ completo (14 dígitos)."}else r="Por favor, insira seu CPF ou CNPJ.","physical"===o?r="Por favor, insira seu CPF.":"legal"===o&&(r="Por favor, insira seu CNPJ.");if(!l)return e.stopPropagation(),e.preventDefault(),g(r),void t.scrollIntoView({behavior:"smooth",block:"center"});v()}var d=document.getElementById("billing-company"),m=document.querySelector(".wc-better-billing-company");if(!m&&d&&(m=d.closest(".wc-block-components-text-input")||d.closest(".wc-better-company-controlled")||d.parentElement),d&&m&&"block"===m.style.display){if(!d.value.trim())return e.stopPropagation(),e.preventDefault(),m.classList.add("has-error"),d.style&&(d.style.borderColor="#d63638"),d.setAttribute("aria-invalid","true"),b("Este campo é obrigatório."),d.scrollIntoView({behavior:"smooth",block:"center"}),void setTimeout(function(){d.focus()},300);m.classList.remove("has-error"),d.style&&(d.style.borderColor=""),d.setAttribute("aria-invalid","false"),y()}}}))}else l&&s()}).observe(document.body,{childList:!0,subtree:!0}),function(){if(c()&&"undefined"!=typeof wp&&wp.data&&wp.data.dispatch)try{var e=wp.data,t=e.dispatch,n=e.select;if(t("wc/store/checkout")){var i=t("wc/store/checkout");if(i.setExtensionData){var o=(n("wc/store/checkout").getExtensionData()||{}).woo_better_person_type||{},l="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_persontype?WooBetterPersonTypeData.billing_persontype:"",r="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cpf?WooBetterPersonTypeData.billing_cpf:"",a="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cnpj?WooBetterPersonTypeData.billing_cnpj:"",s="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_company?WooBetterPersonTypeData.billing_company:"";o.hasOwnProperty("billing_persontype")||(o.billing_persontype=l),o.hasOwnProperty("billing_cpf")||(o.billing_cpf=r),o.hasOwnProperty("billing_cnpj")||(o.billing_cnpj=a),o.hasOwnProperty("billing_company")||(o.billing_company=s),i.setExtensionData("woo_better_person_type",o)}}}catch(e){}}(),new MutationObserver(function(e){var t=!1;e.forEach(function(e){"childList"===e.type&&e.addedNodes.forEach(function(e){e.nodeType===Node.ELEMENT_NODE&&((e.querySelectorAll?e.querySelectorAll("#billing-persontype, #billing_document, #billing-cpf, #billing-cnpj"):[]).length>0||e.id&&("billing-persontype"===e.id||"billing_document"===e.id||"billing-cpf"===e.id||"billing-cnpj"===e.id))&&(t=!0)})}),t&&setTimeout(function(){_(!0);var e=document.getElementById("billing-persontype"),t=document.getElementById("billing_document");if(document.getElementById("billing-cpf"),document.getElementById("billing-cnpj"),e&&!e.dataset.storeApiListener&&(e.addEventListener("change",function(){return _()}),e.dataset.storeApiListener="true"),t&&!t.dataset.storeApiListener){var n=t.value;t.addEventListener("input",function(){var e,t=this.value.replace(/\D/g,""),i="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",o=u(t,i);e="cpf"===o?h(this.value):"cnpj"===o?w(this.value):d(this.value,i),this.value=e,e!==n&&(n=e,m(e,o),_(),f(e,i))}),t.dataset.storeApiListener="true"}},100)}).observe(document.body,{childList:!0,subtree:!0}),setTimeout(function(){if(c()){_(!0);var e=document.getElementById("billing-persontype"),t=document.getElementById("billing_document");if(document.getElementById("billing-cpf"),document.getElementById("billing-cnpj"),e&&!e.dataset.storeApiListener&&(e.addEventListener("change",function(){return _()}),e.dataset.storeApiListener="true"),t&&!t.dataset.storeApiListener){var n=t.value;t.addEventListener("input",function(){var e,t=this.value.replace(/\D/g,""),i="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",o=u(t,i);e="cpf"===o?h(this.value):"cnpj"===o?w(this.value):d(this.value,i),this.value=e,e!==n&&(n=e,m(e,o),_(),f(e,i))}),t.dataset.storeApiListener="true"}}},500)});