document.addEventListener("DOMContentLoaded",function(){var e=!1,t=!1,n=null,o=null;function i(e,t){return"physical"===t?"cpf":"legal"===t?"cnpj":e.length>=11&&e.length<=11?"cpf":e.length>=14||e.length>11?"cnpj":null}function r(e,t){var n=e.replace(/\D/g,"");return"physical"===t?d(e):"legal"===t?p(e):n.length<=11?d(e):p(e)}function l(e,t){var n=document.getElementById("billing-persontype"),o=document.getElementById("billing-cpf"),i=document.getElementById("billing-cnpj");if("cpf"===t)n&&(n.value="physical"),o&&(o.value=e),i&&(i.value="");else if("cnpj"===t)n&&(n.value="legal"),o&&(o.value=""),i&&(i.value=e);else{var r="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both";"physical"===r?(n&&(n.value="physical"),o&&(o.value=e),i&&(i.value="")):"legal"===r?(n&&(n.value="legal"),o&&(o.value=""),i&&(i.value=e)):e.replace(/\D/g,"").length<=11?(o&&(o.value=e),i&&(i.value="")):(o&&(o.value=""),i&&(i.value=e))}}function a(e){var t=document.querySelector(".wc-better-document-error"),n=document.querySelector(".wc-better-billing-document");if(t){var o=t.querySelector("span");o&&(o.textContent=e),t.style.display="block"}n&&n.classList.add("has-error")}function c(){var e=document.querySelector(".wc-better-document-error"),t=document.querySelector(".wc-better-billing-document");e&&(e.style.display="none"),t&&t.classList.remove("has-error")}function s(e,t){var n=e.replace(/\D/g,""),o=!1;e.length>0&&("physical"===t?o=11===n.length:"legal"===t?o=14===n.length:"both"===t&&(o=11===n.length||14===n.length)),o&&c()}function d(e){return e.replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1")}function p(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1")}function u(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o&&(clearTimeout(o),o=null),e?g():o=setTimeout(function(){g(),o=null},1500)}function g(){var e=document.getElementById("billing-persontype"),t=document.getElementById("billing-cpf"),n=document.getElementById("billing-cnpj"),o={billing_persontype:e?e.value:"",billing_cpf:t?t.value:"",billing_cnpj:n?n.value:""};if("undefined"!=typeof wp&&wp.data&&wp.data.dispatch)try{var i=wp.data.dispatch;if(i("wc/store/checkout")){var r=i("wc/store/checkout");r.setExtensionData&&r.setExtensionData("woo_better_person_type",o)}}catch(e){}window.wc&&window.wc.blocksCheckout&&"function"==typeof window.wc.blocksCheckout.extensionCartUpdate&&window.wc.blocksCheckout.extensionCartUpdate({namespace:"woo_better_person_type",data:o})}console.log("opaaaaaaaaa"),new MutationObserver(function(o){var g=document.querySelector("#billing");g||(e=!1),g&&!e&&function(t){var n=document.querySelector('span.wc-block-components-address-card__edit[aria-controls="billing"]');n&&("true"!=n.getAttribute("aria-expanded")&&n.click(),"true"==n.getAttribute("aria-expanded")&&(setTimeout(function(){!function(e){if(!document.getElementById("billing_document")){var t=e.querySelector("#billing-last_name");if(t){"undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_persontype&&WooBetterPersonTypeData.billing_persontype;var n="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cpf?WooBetterPersonTypeData.billing_cpf:"",o="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cnpj?WooBetterPersonTypeData.billing_cnpj:"",c="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",g=("undefined"==typeof WooBetterPersonTypeConfig||WooBetterPersonTypeConfig.show_select,t.parentElement),f="",v="";n?(f=n,v="physical"):o&&(f=o,v="legal"),function(e,t,n){var o=document.createElement("div");o.className="wc-block-components-text-input wc-block-components-address-form__document wc-better-billing-document";var c=document.createElement("input");c.type="text",c.id="billing_document",c.setAttribute("autocomplete","off"),c.setAttribute("aria-label","CPF/CNPJ"),c.setAttribute("aria-invalid","false"),c.setAttribute("autocapitalize","none"),c.value=t;var g="",f="";"physical"===n?(g="Digite seu CPF no formato 000.000.000-00",f="CPF"):"legal"===n?(g="Digite seu CNPJ no formato 00.000.000/0000-00",f="CNPJ"):(g="Digite seu CPF (000.000.000-00) ou CNPJ (00.000.000/0000-00)",f="CPF/CNPJ"),c.setAttribute("title",g);var v=t;c.addEventListener("input",function(){var e,t=i(this.value.replace(/\D/g,""),n);e="cpf"===t?d(this.value):"cnpj"===t?p(this.value):r(this.value,n),this.value=e,e!==v&&(v=e,l(e,t),u(),s(e,n))});var y=document.createElement("label");y.setAttribute("for","billing_document"),y.textContent=f,o.appendChild(c),o.appendChild(y);var m=document.createElement("div");m.className="wc-block-components-validation-error wc-better-document-error",m.setAttribute("role","alert"),m.style.display="none";var b=document.createElement("p");b.id="validate-error-billing_document";var h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("xmlns","http://www.w3.org/2000/svg"),h.setAttribute("viewBox","-2 -2 24 24"),h.setAttribute("width","24"),h.setAttribute("height","24"),h.setAttribute("aria-hidden","true"),h.setAttribute("focusable","false");var P=document.createElementNS("http://www.w3.org/2000/svg","path");P.setAttribute("d","M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"),h.appendChild(P);var w=document.createElement("span");w.textContent="Por favor, insira um documento válido.",b.appendChild(h),b.appendChild(w),m.appendChild(b),o.appendChild(m),t&&o.classList.add("is-active"),c.addEventListener("focus",function(){o.classList.add("is-active")}),c.addEventListener("blur",function(){c.value||(o.classList.remove("is-active"),a("physical"===n?"Por favor insira um CPF válido":"legal"===n?"Por favor insira um CNPJ válido":"Por favor insira um CPF/CNPJ válido"))}),e.insertAdjacentElement("afterend",o)}(g,f,c);var y=document.createElement("input");y.type="hidden",y.id="billing-persontype",y.name="billing-persontype",y.value=v||function(e){return"physical"===e?"physical":"legal"===e?"legal":""}(c),g.insertAdjacentElement("afterend",y);var m=document.createElement("input");m.type="hidden",m.id="billing-cpf",m.name="billing-cpf",m.value=n,y.insertAdjacentElement("afterend",m);var b,h=document.createElement("input");h.type="hidden",h.id="billing-cnpj",h.name="billing-cnpj",h.value=o,m.insertAdjacentElement("afterend",h),(b=document.getElementById("billing_document"))&&b.addEventListener("blur",function(){var e="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",t=this.value.replace(/\D/g,""),n=i(t,e);"both"!==e||n&&("cpf"===n&&11===t.length||"cnpj"===n&&14===t.length)?this.setAttribute("required","true"):"both"===e&&this.removeAttribute("required")}),u(!0)}}}(t)},300),e=!0))}(g);var f=document.querySelector(".wc-block-checkout__actions_row");f&&(n=f.querySelector("button")),n&&!t&&(t=!0,n&&n.addEventListener("click",function(e){document.getElementById("billing-persontype");var t=document.getElementById("billing_document");if(t){var n=t.value.trim(),o=n.replace(/\D/g,""),i="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",r=!1,l="";if(n.length?"physical"===i?11===o.length?r=!0:l="Por favor, insira um CPF válido com 11 dígitos.":"legal"===i?14===o.length?r=!0:l="Por favor, insira um CNPJ válido com 14 dígitos.":"both"===i&&(11===o.length||14===o.length?r=!0:l="Por favor, insira um CPF completo (11 dígitos) ou CNPJ completo (14 dígitos)."):(l="Por favor, insira seu CPF ou CNPJ.","physical"===i?l="Por favor, insira seu CPF.":"legal"===i&&(l="Por favor, insira seu CNPJ.")),!r)return e.stopPropagation(),e.preventDefault(),a(l),void t.scrollIntoView({behavior:"smooth",block:"center"});c()}}))}).observe(document.body,{childList:!0,subtree:!0}),function(){if("undefined"!=typeof wp&&wp.data&&wp.data.dispatch)try{var e=wp.data,t=e.dispatch,n=e.select;if(t("wc/store/checkout")){var o=t("wc/store/checkout");if(o.setExtensionData){var i=(n("wc/store/checkout").getExtensionData()||{}).woo_better_person_type||{},r="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_persontype?WooBetterPersonTypeData.billing_persontype:"",l="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cpf?WooBetterPersonTypeData.billing_cpf:"",a="undefined"!=typeof WooBetterPersonTypeData&&WooBetterPersonTypeData.billing_cnpj?WooBetterPersonTypeData.billing_cnpj:"";i.hasOwnProperty("billing_persontype")||(i.billing_persontype=r),i.hasOwnProperty("billing_cpf")||(i.billing_cpf=l),i.hasOwnProperty("billing_cnpj")||(i.billing_cnpj=a),o.setExtensionData("woo_better_person_type",i)}}}catch(e){}}(),new MutationObserver(function(e){var t=!1;e.forEach(function(e){"childList"===e.type&&e.addedNodes.forEach(function(e){e.nodeType===Node.ELEMENT_NODE&&((e.querySelectorAll?e.querySelectorAll("#billing-persontype, #billing_document, #billing-cpf, #billing-cnpj"):[]).length>0||e.id&&("billing-persontype"===e.id||"billing_document"===e.id||"billing-cpf"===e.id||"billing-cnpj"===e.id))&&(t=!0)})}),t&&setTimeout(function(){u(!0);var e=document.getElementById("billing-persontype"),t=document.getElementById("billing_document");if(document.getElementById("billing-cpf"),document.getElementById("billing-cnpj"),e&&!e.dataset.storeApiListener&&(e.addEventListener("change",function(){return u()}),e.dataset.storeApiListener="true"),t&&!t.dataset.storeApiListener){var n=t.value;t.addEventListener("input",function(){var e,t=this.value.replace(/\D/g,""),o="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",a=i(t,o);e="cpf"===a?d(this.value):"cnpj"===a?p(this.value):r(this.value,o),this.value=e,e!==n&&(n=e,l(e,a),u(),s(e,o))}),t.dataset.storeApiListener="true"}},100)}).observe(document.body,{childList:!0,subtree:!0}),setTimeout(function(){u(!0);var e=document.getElementById("billing-persontype"),t=document.getElementById("billing_document");if(document.getElementById("billing-cpf"),document.getElementById("billing-cnpj"),e&&!e.dataset.storeApiListener&&(e.addEventListener("change",function(){return u()}),e.dataset.storeApiListener="true"),t&&!t.dataset.storeApiListener){var n=t.value;t.addEventListener("input",function(){var e,t=this.value.replace(/\D/g,""),o="undefined"!=typeof WooBetterPersonTypeConfig?WooBetterPersonTypeConfig.person_type:"both",a=i(t,o);e="cpf"===a?d(this.value):"cnpj"===a?p(this.value):r(this.value,o),this.value=e,e!==n&&(n=e,l(e,a),u(),s(e,o))}),t.dataset.storeApiListener="true"}},500)});